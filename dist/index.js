var ca=Object.create;var pt=Object.defineProperty;var pa=Object.getOwnPropertyDescriptor;var da=Object.getOwnPropertyNames;var la=Object.getPrototypeOf,ma=Object.prototype.hasOwnProperty;var fa=(e,r)=>{for(var t in r)pt(e,t,{get:r[t],enumerable:!0})},Rr=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of da(r))!ma.call(e,o)&&o!==t&&pt(e,o,{get:()=>r[o],enumerable:!(a=pa(r,o))||a.enumerable});return e};var v=(e,r,t)=>(t=e!=null?ca(la(e)):{},Rr(r||!e||!e.__esModule?pt(t,"default",{value:e,enumerable:!0}):t,e)),ya=e=>Rr(pt({},"__esModule",{value:!0}),e);var Na={};fa(Na,{Authenticated:()=>ia,CanAccess:()=>ua,ErrorComponent:()=>ea,LayoutWrapper:()=>na,LoginPage:()=>ht,ReadyPage:()=>Bt,Refine:()=>aa,RouteChangeHandler:()=>Nt,UndoableQueue:()=>Gt,createTreeView:()=>ze,file2Base64:()=>zr,getDefaultFilter:()=>Gr,getDefaultSortOrder:()=>Or,handleUseParams:()=>Ft,importCSVMapper:()=>Ge,parseTableParams:()=>_e,parseTableParamsFromQuery:()=>Hr,routeGenerator:()=>ge,setInitialFilters:()=>Ye,setInitialSorters:()=>je,stringifyTableParams:()=>qe,unionFilters:()=>Pe,unionSorters:()=>Je,useApiUrl:()=>oo,useAuthenticated:()=>ft,useBreadcrumb:()=>Ua,useCan:()=>ur,useCanWithoutCache:()=>Ma,useCancelNotification:()=>re,useCheckError:()=>$,useCreate:()=>we,useCreateMany:()=>Dt,useCustom:()=>so,useCustomMutation:()=>io,useDataProvider:()=>Q,useDelete:()=>jr,useDeleteMany:()=>ro,useExport:()=>ga,useForm:()=>Da,useGetIdentity:()=>dt,useGetLocale:()=>bo,useHandleNotification:()=>k,useImport:()=>va,useInvalidate:()=>Z,useIsExistAuthentication:()=>Nr,useList:()=>Ae,useLiveMode:()=>er,useLog:()=>ve,useLogList:()=>Qa,useLogin:()=>mt,useLogout:()=>lt,useMany:()=>Tt,useMenu:()=>Zo,useModal:()=>ba,useMutationMode:()=>te,useNavigation:()=>J,useNotification:()=>pe,useOne:()=>Ve,usePermissions:()=>vr,usePublish:()=>X,useRedirectionAfterSubmission:()=>sr,useRefineContext:()=>Fe,useResource:()=>he,useResourceSubscription:()=>De,useResourceWithRoute:()=>q,useRouterContext:()=>I,useSelect:()=>Ea,useSetLocale:()=>vo,useShow:()=>Pa,useSubscription:()=>xa,useSyncWithLocation:()=>Ut,useTable:()=>Sa,useTitle:()=>Io,useTranslate:()=>E,useUpdate:()=>xt,useUpdateMany:()=>eo,useWarnAboutChange:()=>ke,userFriendlyResourceName:()=>xe});module.exports=ya(Na);var ce=v(require("react"));var Dr=require("react");var wt=v(require("react")),xr=require("react-query");var z=wt.default.createContext({}),gr=({children:e,isProvided:r,...t})=>{let{replace:a}=J(),o=(0,xr.useQueryClient)(),s=()=>{o.invalidateQueries(["useAuthenticated"]),o.invalidateQueries(["getUserIdentity"]),o.invalidateQueries(["usePermissions"])},n=async p=>{var x;try{let R=await((x=t.login)==null?void 0:x.call(t,p));return Promise.resolve(R)}catch(R){return Promise.reject(R)}finally{s()}},m=async p=>{var x;try{let R=await((x=t.logout)==null?void 0:x.call(t,p));return Promise.resolve(R)}catch(R){return Promise.reject(R)}finally{s()}},d=async p=>{var x;try{return await((x=t.checkAuth)==null?void 0:x.call(t,p)),Promise.resolve()}catch(R){return R!=null&&R.redirectPath&&a(R.redirectPath),Promise.reject(R)}finally{s()}};return wt.default.createElement(z.Provider,{value:{...t,login:n,logout:m,checkAuth:d,isProvided:r}},e)};var Pr=require("react-query"),vr=e=>{let{getPermissions:r}=(0,Dr.useContext)(z);return(0,Pr.useQuery)(["usePermissions"],r!=null?r:()=>Promise.resolve(void 0),{enabled:!!r,...e})};var br=v(require("react")),hr=require("react-query");var dt=({queryOptions:e}={})=>{let{getUserIdentity:r}=br.default.useContext(z);return(0,hr.useQuery)(["getUserIdentity"],r!=null?r:()=>Promise.resolve(void 0),{enabled:!!r,retry:!1})};var Mr=v(require("react")),Er=require("react-query");var lt=()=>{let{push:e}=J(),{logout:r}=Mr.default.useContext(z),{open:t}=pe();return(0,Er.useMutation)("useLogout",r,{onSuccess:o=>{o!==!1&&e(o||"/login")},onError:o=>{t==null||t({key:"useLogout-error",type:"error",message:(o==null?void 0:o.name)||"Logout Error",description:(o==null?void 0:o.message)||"Something went wrong during logout"})}})};var Lr=v(require("react")),Ir=require("react-query"),Sr=v(require("qs"));var mt=()=>{let{replace:e}=J(),{login:r}=Lr.default.useContext(z),{useLocation:t}=I(),{search:a}=t(),{close:o,open:s}=pe(),{to:n}=Sr.default.parse(a==null?void 0:a.substring(1));return(0,Ir.useMutation)("useLogin",r,{onSuccess:d=>{if(n)return e(n);d!==!1&&e(d||"/"),o==null||o("login-error")},onError:d=>{s==null||s({message:(d==null?void 0:d.name)||"Login Error",description:(d==null?void 0:d.message)||"Invalid credentials",key:"login-error",type:"error"})}})};var Qr=require("react"),Ur=require("react-query");var ft=e=>{let{checkAuth:r}=(0,Qr.useContext)(z);return(0,Ur.useQuery)(["useAuthenticated",e],async()=>{await(r==null?void 0:r(e))},{retry:!1})};var Br=v(require("react")),Ar=require("react-query");var $=()=>{let{checkError:e}=Br.default.useContext(z),{mutate:r}=lt();return(0,Ar.useMutation)("useCheckError",e,{onError:a=>{r({redirectPath:a})}})};var Vr=require("react");var Nr=()=>{let{isProvided:e}=(0,Vr.useContext)(z);return e||!1};var Fr=require("react-query");var Oe=e=>e/1e3;var Kr=v(require("lodash/zip")),wr=v(require("lodash/fromPairs")),Ge=(e,r=t=>t)=>{let[t,...a]=e;return a.map(o=>(0,wr.default)((0,Kr.default)(t,o))).map((o,s,n)=>r.call(void 0,o,s,n))};var kr=v(require("humanize-string")),kt=v(require("pluralize")),xe=(e="",r)=>{let t=(0,kr.default)(e);return r==="singular"?kt.default.singular(t):kt.default.plural(t)};var Ft=(e={})=>e!=null&&e.id?{...e,id:decodeURIComponent(e.id)}:e;var w=(e,r,t)=>{let a=r||"default",o={all:[a],resourceAll:[a,e||""],list:s=>[...o.resourceAll,"list",{...s,...t}],many:s=>[...o.resourceAll,"getMany",s&&s.map(String),{...t}].filter(n=>n!==void 0),detail:s=>[...o.resourceAll,"detail",s==null?void 0:s.toString(),{...t}],logList:s=>["logList",e,s,t].filter(n=>n!==void 0)};return o};var Ht=(e,r)=>!e||!r?!1:!!e.find(t=>t===r);var ge=(e,r)=>{let t;if(e.parentName){let a=r.find(o=>o.name===e.parentName);a!=null&&a.parentName?(t=`${ge(a,r)}/${e.name}`,ge(a,r)):e.parentName&&(t=`${e.parentName}/${e.name}`)}else t=e.name;return t};var ze=e=>{var n,m,d;let r=[],t={},a={},o,s;for(let p=0;p<e.length;p++){o=e[p];let x=(d=(m=o.route)!=null?m:(n=o.options)==null?void 0:n.route)!=null?d:"";t[x]=o,t[x].children=[],a[o.name]=o,a[o.name].children=[]}for(let p in t)t.hasOwnProperty(p)&&(s=t[p],s.parentName&&a[s.parentName]?a[s.parentName].children.push(s):r.push(s));return r};var Ae=({resource:e,config:r,queryOptions:t,successNotification:a,errorNotification:o,metaData:s,liveMode:n,onLiveEvent:m,liveParams:d,dataProviderName:p})=>{let x=Q(),R=w(e,p,s),{getList:y}=x(p),i=E(),{mutate:u}=$(),l=k(),C=(t==null?void 0:t.enabled)===void 0||(t==null?void 0:t.enabled)===!0;return De({resource:e,types:["*"],params:{metaData:s,pagination:r==null?void 0:r.pagination,hasPagination:r==null?void 0:r.hasPagination,sort:r==null?void 0:r.sort,filters:r==null?void 0:r.filters,subscriptionType:"useList",...d},channel:`resources/${e}`,enabled:C,liveMode:n,onLiveEvent:m}),(0,Fr.useQuery)(R.list(r),()=>{let{hasPagination:T,...g}=r||{};return y({resource:e,...g,hasPagination:T,metaData:s})},{...t,onSuccess:T=>{var D;(D=t==null?void 0:t.onSuccess)==null||D.call(t,T);let g=typeof a=="function"?a(T,{metaData:s,config:r},e):a;l(g)},onError:T=>{var D;u(T),(D=t==null?void 0:t.onError)==null||D.call(t,T);let g=typeof o=="function"?o(T,{metaData:s,config:r},e):o;l(g,{key:`${e}-useList-notification`,message:i("common:notifications.error",{statusCode:T.statusCode},`Error (status code: ${T.statusCode})`),description:T.message,type:"error"})}})};var _r=require("react-query");var yt=v(require("qs")),$t=v(require("lodash/unionWith")),Wt=v(require("lodash/differenceWith")),_e=e=>{let{current:r,pageSize:t,sorter:a,filters:o}=yt.default.parse(e.substring(1));return{parsedCurrent:r&&Number(r),parsedPageSize:t&&Number(t),parsedSorter:a!=null?a:[],parsedFilters:o!=null?o:[]}},Hr=e=>{let r=yt.default.stringify(e);return _e(`/${r}`)},qe=e=>{let r={skipNulls:!0,arrayFormat:"indices",encode:!1},{pagination:t,sorter:a,filters:o}=e;return yt.default.stringify({...t||{},sorter:a,filters:o},r)},$r=(e,r)=>("field"in e?e.field:void 0)==("field"in r?r.field:void 0)&&e.operator==r.operator,Wr=(e,r)=>e.field==r.field,Pe=(e,r,t=[])=>(0,$t.default)(e,r,t,$r).filter(a=>a.value!==void 0&&a.value!==null&&(a.operator!=="or"||a.operator==="or"&&a.value.length!==0)),Je=(e,r)=>(0,$t.default)(e,r,Wr).filter(t=>t.order!==void 0&&t.order!==null),Ye=(e,r)=>[...(0,Wt.default)(r,e,$r),...e],je=(e,r)=>[...(0,Wt.default)(r,e,Wr),...e],Or=(e,r)=>{if(!r)return;let t=r.find(a=>a.field===e);if(t)return t.order},Gr=(e,r,t="eq")=>{let a=r==null?void 0:r.find(o=>{if(o.operator!=="or"){let{operator:s,field:n}=o;return n===e&&s===t}});if(a)return a.value||[]};var zr=e=>new Promise((r,t)=>{let a=new FileReader,o=()=>{a.result&&(a.removeEventListener("load",o,!1),r(a.result))};a.addEventListener("load",o,!1),a.readAsDataURL(e.originFileObj),a.onerror=s=>(a.removeEventListener("load",o,!1),t(s))});var Ve=({resource:e,id:r,queryOptions:t,successNotification:a,errorNotification:o,metaData:s,liveMode:n,onLiveEvent:m,liveParams:d,dataProviderName:p})=>{let x=Q(),R=w(e,p,s),{getOne:y}=x(p),i=E(),{mutate:u}=$(),l=k();return De({resource:e,types:["*"],channel:`resources/${e}`,params:{ids:r?[r]:[],id:r,metaData:s,subscriptionType:"useOne",...d},enabled:t==null?void 0:t.enabled,liveMode:n,onLiveEvent:m}),(0,_r.useQuery)(R.detail(r),()=>y({resource:e,id:r,metaData:s}),{...t,onSuccess:f=>{var g;(g=t==null?void 0:t.onSuccess)==null||g.call(t,f);let T=typeof a=="function"?a(f,{id:r,metaData:s},e):a;l(T)},onError:f=>{var g;u(f),(g=t==null?void 0:t.onError)==null||g.call(t,f);let T=typeof o=="function"?o(f,{id:r,metaData:s},e):o;l(T,{key:`${r}-${e}-getOne-notification`,message:i("notifications.error",{statusCode:f.statusCode},`Error (status code: ${f.statusCode})`),description:f.message,type:"error"})}})};var qr=require("react-query");var Tt=({resource:e,ids:r,queryOptions:t,successNotification:a,errorNotification:o,metaData:s,liveMode:n,onLiveEvent:m,liveParams:d,dataProviderName:p})=>{let x=Q(),R=w(e,p,s),{getMany:y}=x(p),i=E(),{mutate:u}=$(),l=k(),C=(t==null?void 0:t.enabled)===void 0||(t==null?void 0:t.enabled)===!0;return De({resource:e,types:["*"],params:{ids:r!=null?r:[],metaData:s,subscriptionType:"useMany",...d},channel:`resources/${e}`,enabled:C,liveMode:n,onLiveEvent:m}),(0,qr.useQuery)(R.many(r),()=>y({resource:e,ids:r,metaData:s}),{...t,onSuccess:T=>{var D;(D=t==null?void 0:t.onSuccess)==null||D.call(t,T);let g=typeof a=="function"?a(T,r,e):a;l(g)},onError:T=>{var D;u(T),(D=t==null?void 0:t.onError)==null||D.call(t,T);let g=typeof o=="function"?o(T,r,e):o;l(g,{key:`${r[0]}-${e}-getMany-notification`,message:i("notifications.error",{statusCode:T.statusCode},`Error (status code: ${T.statusCode})`),description:T.message,type:"error"})}})};var Rt=require("react-query");var Ne=v(require("react")),Jr=require("react-dom");var Ct=Ne.default.createContext({notifications:[],notificationDispatch:()=>!1}),Ta=[],Ca=(e,r)=>{switch(r.type){case"ADD":return[...e.filter(t=>t.id!=r.payload.id&&t.resource==r.payload.resource),{...r.payload,isRunning:!0}];case"REMOVE":return e.filter(t=>t.id!=r.payload.id&&t.resource==r.payload.resource);case"DECREASE_NOTIFICATION_SECOND":return e.map(t=>t.id==r.payload.id&&t.resource==r.payload.resource?{...t,seconds:r.payload.seconds-1e3}:t);default:return e}},Ot=({children:e})=>{let[r,t]=(0,Ne.useReducer)(Ca,Ta),a={notifications:r,notificationDispatch:t};return Ne.default.createElement(Ct.Provider,{value:a},e,typeof window<"u"&&(0,Jr.createPortal)(Ne.default.createElement(Gt,{notifications:r}),document.body))};var zt=v(require("pluralize"));var xt=()=>{let e=(0,Rt.useQueryClient)(),r=Q(),{mutationMode:t,undoableTimeout:a}=te(),o=E(),{mutate:s}=$(),n=X(),{log:m}=ve(),{notificationDispatch:d}=re(),p=k(),x=Z();return(0,Rt.useMutation)(({id:y,values:i,resource:u,mutationMode:l,undoableTimeout:C,onCancel:f,metaData:T,dataProviderName:g})=>{let D=l!=null?l:t,h=C!=null?C:a;return D!=="undoable"?r(g).update({resource:u,id:y,variables:i,metaData:T}):new Promise((b,M)=>{let S=()=>{r(g).update({resource:u,id:y,variables:i,metaData:T}).then(L=>b(L)).catch(L=>M(L))},B=()=>{M({message:"mutationCancelled"})};f&&f(B),d({type:"ADD",payload:{id:y,resource:u,cancelMutation:B,doMutation:S,seconds:h,isSilent:!!f}})})},{onMutate:async({resource:y,id:i,mutationMode:u,values:l,dataProviderName:C})=>{let f=w(y,C),T=e.getQueriesData(f.resourceAll),g=u!=null?u:t;return await e.cancelQueries(f.resourceAll,void 0,{silent:!0}),g!=="pessimistic"&&(e.setQueriesData(f.list(),D=>{if(!D)return null;let h=D.data.map(P=>{var b;return((b=P.id)==null?void 0:b.toString())===(i==null?void 0:i.toString())?{id:i,...l}:P});return{...D,data:h}}),e.setQueriesData(f.many(),D=>{if(!D)return null;let h=D.data.map(P=>{var b;return((b=P.id)==null?void 0:b.toString())===(i==null?void 0:i.toString())&&(P={id:i,...l}),P});return{...D,data:h}}),e.setQueriesData(f.detail(i),D=>D?{...D,data:{...D.data,...l}}:null)),{previousQueries:T,queryKey:f}},onSettled:(y,i,{id:u,resource:l,dataProviderName:C,invalidates:f=["list","many","detail"]})=>{x({resource:l,dataProviderName:C,invalidates:f,id:u}),d({type:"REMOVE",payload:{id:u,resource:l}})},onSuccess:(y,{id:i,resource:u,successNotification:l,dataProviderName:C,values:f,metaData:T},g)=>{var L;let D=zt.default.singular(u),h=typeof l=="function"?l(y,{id:i,values:f},u):l;p(h,{key:`${i}-${u}-notification`,description:o("notifications.success","Successful"),message:o("notifications.editSuccess",{resource:o(`${u}.${u}`,D)},`Successfully updated ${D}`),type:"success"}),n==null||n({channel:`resources/${u}`,type:"updated",payload:{ids:(L=y.data)!=null&&L.id?[y.data.id]:void 0},date:new Date});let P;if(g){let N=e.getQueryData(g.queryKey.detail(i));P=Object.keys(f).reduce((K,_)=>{var A;return K[_]=(A=N==null?void 0:N.data)==null?void 0:A[_],K},{})}let{fields:b,operation:M,variables:S,...B}=T||{};m==null||m.mutate({action:"update",resource:u,data:f,previousData:P,meta:{id:i,dataProviderName:C,...B}})},onError:(y,{id:i,resource:u,errorNotification:l,values:C},f)=>{if(f)for(let T of f.previousQueries)e.setQueryData(T[0],T[1]);if(y.message!=="mutationCancelled"){s==null||s(y);let T=zt.default.singular(u),g=typeof l=="function"?l(y,{id:i,values:C},u):l;p(g,{key:`${i}-${u}-notification`,message:o("notifications.editError",{resource:o(`${u}.${u}`,T),statusCode:y.statusCode},`Error when updating ${T} (status code: ${y.statusCode})`),description:y.message,type:"error"})}}})};var Yr=require("react-query"),_t=v(require("pluralize"));var we=()=>{let{mutate:e}=$(),r=Q(),t=Z(),a=E(),o=X(),{log:s}=ve(),n=k();return(0,Yr.useMutation)(({resource:d,values:p,metaData:x,dataProviderName:R})=>r(R).create({resource:d,variables:p,metaData:x}),{onSuccess:(d,{resource:p,successNotification:x,dataProviderName:R,invalidates:y=["list","many"],values:i,metaData:u})=>{var h,P,b;let l=_t.default.singular(p),C=typeof x=="function"?x(d,i,p):x;n(C,{key:`create-${p}-notification`,message:a("notifications.createSuccess",{resource:a(`${p}.${p}`,l)},`Successfully created ${l}`),description:a("notifications.success","Success"),type:"success"}),t({resource:p,dataProviderName:R,invalidates:y}),o==null||o({channel:`resources/${p}`,type:"created",payload:{ids:(h=d==null?void 0:d.data)!=null&&h.id?[d.data.id]:void 0},date:new Date});let{fields:f,operation:T,variables:g,...D}=u||{};s==null||s.mutate({action:"create",resource:p,data:i,meta:{dataProviderName:R,id:(b=(P=d==null?void 0:d.data)==null?void 0:P.id)!=null?b:void 0,...D}})},onError:(d,{resource:p,errorNotification:x,values:R})=>{e(d);let y=_t.default.singular(p),i=typeof x=="function"?x(d,R,p):x;n(i,{key:`create-${p}-notification`,description:d.message,message:a("notifications.createError",{resource:a(`${p}.${p}`,y),statusCode:d.statusCode},`There was an error creating ${y} (status code: ${d.statusCode})`),type:"error"})}})};var gt=require("react-query"),qt=v(require("pluralize"));var jr=()=>{let{mutate:e}=$(),r=Q(),t=(0,gt.useQueryClient)(),{mutationMode:a,undoableTimeout:o}=te(),{notificationDispatch:s}=re(),n=E(),m=X(),{log:d}=ve(),p=k(),x=Z();return(0,gt.useMutation)(({id:y,mutationMode:i,undoableTimeout:u,resource:l,onCancel:C,metaData:f,dataProviderName:T,values:g})=>{let D=i!=null?i:a,h=u!=null?u:o;return D!=="undoable"?r(T).deleteOne({resource:l,id:y,metaData:f,variables:g}):new Promise((b,M)=>{let S=()=>{r(T).deleteOne({resource:l,id:y,metaData:f,variables:g}).then(L=>b(L)).catch(L=>M(L))},B=()=>{M({message:"mutationCancelled"})};C&&C(B),s({type:"ADD",payload:{id:y,resource:l,cancelMutation:B,doMutation:S,seconds:h,isSilent:!!C}})})},{onMutate:async({id:y,resource:i,mutationMode:u,dataProviderName:l})=>{let C=w(i,l),f=u!=null?u:a;await t.cancelQueries(C.resourceAll,void 0,{silent:!0});let T=t.getQueriesData(C.resourceAll);return f!=="pessimistic"&&(t.setQueriesData(C.list(),g=>g?{data:g.data.filter(h=>{var P;return((P=h.id)==null?void 0:P.toString())!==y.toString()}),total:g.total-1}:null),t.setQueriesData(C.many(),g=>{if(!g)return null;let D=g.data.filter(h=>{var P;return((P=h.id)==null?void 0:P.toString())!==(y==null?void 0:y.toString())});return{...g,data:D}})),{previousQueries:T,queryKey:C}},onSettled:(y,i,{id:u,resource:l,dataProviderName:C,invalidates:f=["list","many"]})=>{x({resource:l,dataProviderName:C,invalidates:f}),s({type:"REMOVE",payload:{id:u,resource:l}})},onSuccess:(y,{id:i,resource:u,successNotification:l,dataProviderName:C,metaData:f},T)=>{let g=qt.default.singular(u!=null?u:"");t.removeQueries(T==null?void 0:T.queryKey.detail(i));let D=typeof l=="function"?l(y,i,u):l;p(D,{key:`${i}-${u}-notification`,description:n("notifications.success","Success"),message:n("notifications.deleteSuccess",{resource:n(`${u}.${u}`,g)},`Successfully deleted a ${g}`),type:"success"}),m==null||m({channel:`resources/${u}`,type:"deleted",payload:{ids:i?[i]:[]},date:new Date});let{fields:h,operation:P,variables:b,...M}=f||{};d==null||d.mutate({action:"delete",resource:u,meta:{id:i,dataProviderName:C,...M}}),t.removeQueries(T==null?void 0:T.queryKey.detail(i))},onError:(y,{id:i,resource:u,errorNotification:l},C)=>{if(C)for(let f of C.previousQueries)t.setQueryData(f[0],f[1]);if(y.message!=="mutationCancelled"){e(y);let f=qt.default.singular(u!=null?u:""),T=typeof l=="function"?l(y,i,u):l;p(T,{key:`${i}-${u}-notification`,message:n("notifications.deleteError",{resource:f,statusCode:y.statusCode},`Error (status code: ${y.statusCode})`),description:y.message,type:"error"})}}})};var Xr=require("react-query");var Zr=v(require("pluralize")),Dt=()=>{let e=Q(),r=E(),t=X(),a=k(),o=Z();return(0,Xr.useMutation)(({resource:n,values:m,metaData:d,dataProviderName:p})=>e(p).createMany({resource:n,variables:m,metaData:d}),{onSuccess:(n,{resource:m,successNotification:d,dataProviderName:p,invalidates:x=["list","many"],values:R})=>{let y=Zr.default.plural(m),i=typeof d=="function"?d(n,R,m):d;a(i,{key:`createMany-${m}-notification`,message:r("notifications.createSuccess",{resource:r(`${m}.${m}`,m)},`Successfully created ${y}`),description:r("notifications.success","Success"),type:"success"}),o({resource:m,dataProviderName:p,invalidates:x});let u=n==null?void 0:n.data.filter(l=>(l==null?void 0:l.id)!==void 0).map(l=>l.id);t==null||t({channel:`resources/${m}`,type:"created",payload:{ids:u},date:new Date})},onError:(n,{resource:m,errorNotification:d,values:p})=>{let x=typeof d=="function"?d(n,p,m):d;a(x,{key:`createMany-${m}-notification`,description:n.message,message:r("notifications.createError",{resource:r(`${m}.${m}`,m),statusCode:n.statusCode},`There was an error creating ${m} (status code: ${n.statusCode}`),type:"error"})}})};var Pt=require("react-query"),Jt=v(require("pluralize"));var eo=()=>{let e=(0,Pt.useQueryClient)(),r=Q(),t=E(),{mutationMode:a,undoableTimeout:o}=te(),{mutate:s}=$(),{notificationDispatch:n}=re(),m=X(),d=k(),p=Z();return(0,Pt.useMutation)(({ids:R,values:y,resource:i,onCancel:u,mutationMode:l,undoableTimeout:C,metaData:f,dataProviderName:T})=>{let g=l!=null?l:a,D=C!=null?C:o;return g!=="undoable"?r(T).updateMany({resource:i,ids:R,variables:y,metaData:f}):new Promise((P,b)=>{let M=()=>{r(T).updateMany({resource:i,ids:R,variables:y,metaData:f}).then(B=>P(B)).catch(B=>b(B))},S=()=>{b({message:"mutationCancelled"})};u&&u(S),n({type:"ADD",payload:{id:R,resource:i,cancelMutation:S,doMutation:M,seconds:D,isSilent:!!u}})})},{onMutate:async({resource:R,ids:y,values:i,mutationMode:u,dataProviderName:l,metaData:C})=>{let f=w(R,l,C),T=u!=null?u:a;await e.cancelQueries(f.resourceAll,void 0,{silent:!0});let g=e.getQueriesData(f.resourceAll);if(T!=="pessimistic"){e.setQueriesData(f.list(),D=>{if(!D)return null;let h=D.data.map(P=>P.id!==void 0&&y.filter(b=>b!==void 0).map(String).includes(P.id.toString())?{...P,...i}:P);return{...D,data:h}}),e.setQueriesData(f.many(),D=>{if(!D)return null;let h=D.data.map(P=>P.id!==void 0&&y.filter(b=>b!==void 0).map(String).includes(P.id.toString())?{...P,...i}:P);return{...D,data:h}});for(let D of y)e.setQueriesData(f.detail(D),h=>{if(!h)return null;let P={...h.data,...i};return{...h,data:P}})}return{previousQueries:g,queryKey:f}},onSettled:(R,y,{ids:i,resource:u,dataProviderName:l})=>{p({resource:u,invalidates:["list","many"],dataProviderName:l}),i.forEach(C=>p({resource:u,invalidates:["detail"],dataProviderName:l,id:C})),n({type:"REMOVE",payload:{id:i,resource:u}})},onSuccess:(R,{ids:y,resource:i,successNotification:u,values:l})=>{let C=Jt.default.singular(i),f=typeof u=="function"?u(R,{ids:y,values:l},i):u;d(f,{key:`${y}-${i}-notification`,description:t("notifications.success","Successful"),message:t("notifications.editSuccess",{resource:t(`${i}.${i}`,i)},`Successfully updated ${C}`),type:"success"}),m==null||m({channel:`resources/${i}`,type:"updated",payload:{ids:y.map(String)},date:new Date})},onError:(R,{ids:y,resource:i,errorNotification:u,values:l},C)=>{if(C)for(let f of C.previousQueries)e.setQueryData(f[0],f[1]);if(R.message!=="mutationCancelled"){s==null||s(R);let f=Jt.default.singular(i),T=typeof u=="function"?u(R,{ids:y,values:l},i):u;d(T,{key:`${y}-${i}-updateMany-error-notification`,message:t("notifications.editError",{resource:f,statusCode:R.statusCode},`Error when updating ${f} (status code: ${R.statusCode})`),description:R.message,type:"error"})}}})};var vt=require("react-query"),to=v(require("pluralize"));var ro=()=>{let{mutate:e}=$(),{mutationMode:r,undoableTimeout:t}=te(),a=Q(),{notificationDispatch:o}=re(),s=E(),n=X(),m=k(),d=Z(),p=(0,vt.useQueryClient)();return(0,vt.useMutation)(({resource:R,ids:y,mutationMode:i,undoableTimeout:u,onCancel:l,metaData:C,dataProviderName:f,values:T})=>{let g=i!=null?i:r,D=u!=null?u:t;return g!=="undoable"?a(f).deleteMany({resource:R,ids:y,metaData:C,variables:T}):new Promise((P,b)=>{let M=()=>{a(f).deleteMany({resource:R,ids:y,metaData:C,variables:T}).then(B=>P(B)).catch(B=>b(B))},S=()=>{b({message:"mutationCancelled"})};l&&l(S),o({type:"ADD",payload:{id:y,resource:R,cancelMutation:S,doMutation:M,seconds:D,isSilent:!!l}})})},{onMutate:async({ids:R,resource:y,mutationMode:i,dataProviderName:u})=>{let l=w(y,u),C=i!=null?i:r;await p.cancelQueries(l.resourceAll,void 0,{silent:!0});let f=p.getQueriesData(l.resourceAll);if(C!=="pessimistic"){p.setQueriesData(l.list(),T=>T?{data:T.data.filter(D=>D.id&&!R.map(String).includes(D.id.toString())),total:T.total-1}:null),p.setQueriesData(l.many(),T=>{if(!T)return null;let g=T.data.filter(D=>D.id?!R.map(String).includes(D.id.toString()):!1);return{...T,data:g}});for(let T of R)p.setQueriesData(l.detail(T),g=>!g||g.data.id==T?null:{...g})}return{previousQueries:f,queryKey:l}},onSettled:(R,y,{resource:i,ids:u,dataProviderName:l,invalidates:C=["list","many"]})=>{d({resource:i,dataProviderName:l,invalidates:C}),o({type:"REMOVE",payload:{id:u,resource:i}})},onSuccess:(R,{ids:y,resource:i,successNotification:u},l)=>{y.forEach(f=>p.removeQueries(l==null?void 0:l.queryKey.detail(f)));let C=typeof u=="function"?u(R,y,i):u;m(C,{key:`${y}-${i}-notification`,description:s("notifications.success","Success"),message:s("notifications.deleteSuccess",{resource:s(`${i}.${i}`,i)},`Successfully deleted ${i}`),type:"success"}),n==null||n({channel:`resources/${i}`,type:"deleted",payload:{ids:y},date:new Date}),y.forEach(f=>p.removeQueries(l==null?void 0:l.queryKey.detail(f)))},onError:(R,{ids:y,resource:i,errorNotification:u},l)=>{if(l)for(let C of l.previousQueries)p.setQueryData(C[0],C[1]);if(R.message!=="mutationCancelled"){e(R);let C=to.default.singular(i),f=typeof u=="function"?u(R,y,i):u;m(f,{key:`${y}-${i}-notification`,message:s("notifications.deleteError",{resource:C,statusCode:R.statusCode},`Error (status code: ${R.statusCode})`),description:R.message,type:"error"})}}})};var oo=e=>{let r=Q(),{getApiUrl:t}=r(e);return t()};var ao=require("react-query");var so=({url:e,method:r,config:t,queryOptions:a,successNotification:o,errorNotification:s,metaData:n,dataProviderName:m})=>{let d=Q(),{custom:p}=d(m),{mutate:x}=$(),R=E(),y=k();if(p)return(0,ao.useQuery)([m,"custom",r,e,{...t,...n}],()=>p({url:e,method:r,...t,metaData:n}),{...a,onSuccess:u=>{var C;(C=a==null?void 0:a.onSuccess)==null||C.call(a,u);let l=typeof o=="function"?o(u,{...t,...n}):o;y(l)},onError:u=>{var C;x(u),(C=a==null?void 0:a.onError)==null||C.call(a,u);let l=typeof s=="function"?s(u,{...t,...n}):s;y(l,{key:`${r}-notification`,message:R("common:notifications.error",{statusCode:u.statusCode},`Error (status code: ${u.statusCode})`),description:u.message,type:"error"})}});throw Error("Not implemented custom on data provider.")};var no=require("react-query");var io=()=>{let e=k(),r=Q(),t=E();return(0,no.useMutation)(({url:o,method:s,values:n,metaData:m,dataProviderName:d,config:p})=>{let{custom:x}=r(d);if(x)return x({url:o,method:s,payload:n,metaData:m,headers:{...p==null?void 0:p.headers}});throw Error("Not implemented custom on data provider.")},{onSuccess:(o,{successNotification:s,config:n,metaData:m})=>{let d=typeof s=="function"?s(o,{...n,...m}):s;e(d)},onError:(o,{errorNotification:s,method:n,config:m,metaData:d})=>{let p=typeof s=="function"?s(o,{...m,...d}):s;e(p,{key:`${n}-notification`,message:t("common:notifications.error",{statusCode:o.statusCode},`Error (status code: ${o.statusCode})`),description:o.message,type:"error"})}})};var bt=require("react");var Yt=v(require("react")),Ra=()=>({default:{create:()=>Promise.resolve({data:{id:1}}),createMany:()=>Promise.resolve({data:[]}),deleteOne:()=>Promise.resolve({data:{id:1}}),deleteMany:()=>Promise.resolve({data:[]}),getList:()=>Promise.resolve({data:[],total:0}),getMany:()=>Promise.resolve({data:[]}),getOne:()=>Promise.resolve({data:{id:1}}),update:()=>Promise.resolve({data:{id:1}}),updateMany:()=>Promise.resolve({data:[]}),custom:()=>Promise.resolve({data:{}}),getApiUrl:()=>""}}),Xe=Yt.default.createContext(Ra()),uo=({children:e,...r})=>{let t;return!r.hasOwnProperty("updateMany")||!r.hasOwnProperty("createMany")?t=r:t={default:r},Yt.default.createElement(Xe.Provider,{value:t},e)};var Q=()=>{let e=(0,bt.useContext)(Xe);return(0,bt.useCallback)(t=>{if(t){if(!e[t])throw new Error(`"${t}" Data provider not found`);return e[t]}if(e.default)return e.default;throw new Error('There is no "default" data provider. Please pass dataProviderName.')},[e])};var Ze=require("react"),mo=require("react-query");var jt=v(require("react")),de=jt.default.createContext(void 0),co=({liveProvider:e,children:r})=>jt.default.createElement(de.Provider,{value:e},r);var Zt=v(require("react"));var po=v(require("react")),Xt=({children:e})=>po.default.createElement("div",null,e);var Y=Zt.default.createContext({hasDashboard:!1,mutationMode:"pessimistic",warnWhenUnsavedChanges:!1,syncWithLocation:!1,undoableTimeout:5e3,Title:void 0,Sider:void 0,Header:void 0,Footer:void 0,Layout:Xt,OffLayoutArea:void 0,liveMode:"off",onLiveEvent:void 0}),lo=({hasDashboard:e,mutationMode:r,warnWhenUnsavedChanges:t,syncWithLocation:a,undoableTimeout:o,children:s,DashboardPage:n,Title:m,Layout:d=Xt,Header:p,Sider:x,Footer:R,OffLayoutArea:y,LoginPage:i=ht,catchAll:u,liveMode:l="off",onLiveEvent:C})=>Zt.default.createElement(Y.Provider,{value:{hasDashboard:e,mutationMode:r,warnWhenUnsavedChanges:t,syncWithLocation:a,Title:m,undoableTimeout:o,Layout:d,Header:p,Sider:x,Footer:R,OffLayoutArea:y,DashboardPage:n,LoginPage:i,catchAll:u,liveMode:l,onLiveEvent:C}},s);var De=({resource:e,params:r,channel:t,types:a,enabled:o=!0,liveMode:s,onLiveEvent:n})=>{let m=(0,mo.useQueryClient)(),d=w(e),p=(0,Ze.useContext)(de),{liveMode:x,onLiveEvent:R}=(0,Ze.useContext)(Y),y=s!=null?s:x;(0,Ze.useEffect)(()=>{let i;return y&&y!=="off"&&o&&(i=p==null?void 0:p.subscribe({channel:t,params:{resource:e,...r},types:a,callback:u=>{y==="auto"&&m.invalidateQueries(d.resourceAll),n==null||n(u),R==null||R(u)}})),()=>{i&&(p==null||p.unsubscribe(i))}},[o])};var fo=require("react");var er=e=>{let{liveMode:r}=(0,fo.useContext)(Y);return e!=null?e:r};var Mt=require("react");var xa=({params:e,channel:r,types:t=["*"],enabled:a=!0,onLiveEvent:o})=>{let s=(0,Mt.useContext)(de);(0,Mt.useEffect)(()=>{let n;return a&&(n=s==null?void 0:s.subscribe({channel:r,params:e,types:t,callback:o})),()=>{n&&(s==null||s.unsubscribe(n))}},[a])};var yo=require("react");var X=()=>{let e=(0,yo.useContext)(de);return e==null?void 0:e.publish};var Co=require("react");var tr=v(require("react")),be=tr.default.createContext({resources:[]}),To=({resources:e,children:r})=>tr.default.createElement(be.Provider,{value:{resources:e}},r);var he=({resourceName:e,resourceNameOrRouteName:r,recordItemId:t}={})=>{let{resources:a}=(0,Co.useContext)(be),o=q(),{useParams:s}=I(),n=s(),m=o(r!=null?r:n.resource),d=e!=null?e:m.name,p=t!=null?t:n.id;return{resources:a,resource:m,resourceName:d,id:p}};var Et=require("react");var q=()=>{let{resources:e}=(0,Et.useContext)(be);return(0,Et.useCallback)(t=>{let a=e.find(o=>o.route===t);if(!a){let o=e.find(s=>s.name===t);return o!=null?o:{name:t,route:t}}return a},[e])};var Ro=require("react");var re=()=>{let{notifications:e,notificationDispatch:r}=(0,Ro.useContext)(Ct);return{notifications:e,notificationDispatch:r}};var go=require("react");var Lt=v(require("react"));var et=(0,Lt.createContext)({}),xo=({open:e,close:r,children:t})=>Lt.default.createElement(et.Provider,{value:{open:e,close:r}},t);var pe=()=>{let{open:e,close:r}=(0,go.useContext)(et);return{open:e,close:r}};var Do=require("react");var k=()=>{let{open:e}=pe();return(0,Do.useCallback)((t,a)=>{t!==!1&&(t?e==null||e(t):a&&(e==null||e(a)))},[])};var It=require("react");var rr=v(require("react"));var oe=rr.default.createContext({}),Po=({children:e,i18nProvider:r})=>rr.default.createElement(oe.Provider,{value:{i18nProvider:r}},e);var vo=()=>{let{i18nProvider:e}=(0,It.useContext)(oe);return(0,It.useCallback)(r=>e==null?void 0:e.changeLocale(r),[])};var St=require("react");var E=()=>{let{i18nProvider:e}=(0,St.useContext)(oe);return(0,St.useMemo)(()=>{function t(a,o,s){var n,m;return(m=(n=e==null?void 0:e.translate(a,o,s))!=null?n:s)!=null?m:typeof o=="string"&&typeof s>"u"?o:a}return t},[e])};var Qt=require("react");var bo=()=>{let{i18nProvider:e}=(0,Qt.useContext)(oe);return(0,Qt.useCallback)(()=>e==null?void 0:e.getLocale(),[])};var ho=require("react");var te=()=>{let{mutationMode:e,undoableTimeout:r}=(0,ho.useContext)(Y);return{mutationMode:e,undoableTimeout:r}};var ar=require("react");var tt=v(require("react")),or=tt.default.createContext({}),Mo=({children:e})=>{let[r,t]=(0,tt.useState)(!1);return tt.default.createElement(or.Provider,{value:{warnWhen:r,setWarnWhen:t}},e)};var ke=()=>{let{warnWhenUnsavedChanges:e}=(0,ar.useContext)(Y),{warnWhen:r,setWarnWhen:t}=(0,ar.useContext)(or);return{warnWhenUnsavedChanges:e,warnWhen:Boolean(r),setWarnWhen:t!=null?t:()=>{}}};var Eo=require("react");var Ut=()=>{let{syncWithLocation:e}=(0,Eo.useContext)(Y);return{syncWithLocation:e}};var Lo=require("react");var Io=()=>{let{Title:e}=(0,Lo.useContext)(Y);return e};var So=require("react");var Fe=()=>{let{Footer:e,Header:r,Layout:t,OffLayoutArea:a,Sider:o,Title:s,hasDashboard:n,mutationMode:m,syncWithLocation:d,undoableTimeout:p,warnWhenUnsavedChanges:x,DashboardPage:R,LoginPage:y,catchAll:i}=(0,So.useContext)(Y);return{Footer:e,Header:r,Layout:t,OffLayoutArea:a,Sider:o,Title:s,hasDashboard:n,mutationMode:m,syncWithLocation:d,undoableTimeout:p,warnWhenUnsavedChanges:x,DashboardPage:R,LoginPage:y,catchAll:i}};var Qo=require("react");var Uo=require("export-to-csv-fix-source-map"),ga=({resourceName:e,sorter:r,filters:t,maxItemCount:a,pageSize:o=20,mapData:s=x=>x,exportOptions:n,metaData:m,dataProviderName:d,onError:p}={})=>{let[x,R]=(0,Qo.useState)(!1),y=q(),i=Q(),{useParams:u}=I(),{resource:l}=u(),{name:C}=y(l);e&&(C=e);let f=`${xe(C,"plural")}-${new Date().toLocaleString()}`,{getList:T}=i(d);return{isLoading:x,triggerExport:async()=>{R(!0);let D=[],h=1,P=!0;for(;P;)try{let{data:M,total:S}=await T({resource:C,filters:t,sort:r,pagination:{current:h,pageSize:o},metaData:m});h++,D.push(...M),a&&D.length>=a&&(D=D.slice(0,a),P=!1),S===D.length&&(P=!1)}catch(M){R(!1),P=!1,p==null||p(M);return}new Uo.ExportToCsv({filename:f,useKeysAsHeaders:!0,...n}).generateCsv(D.map(s)),R(!1)}}};var Bo=v(require("react"));var Da=({action:e,resource:r,id:t,onMutationSuccess:a,onMutationError:o,redirect:s,successNotification:n,errorNotification:m,metaData:d,mutationMode:p,liveMode:x,onLiveEvent:R,liveParams:y,undoableTimeout:i,dataProviderName:u,invalidates:l,queryOptions:C}={})=>{var ct;let{useParams:f}=I(),{resource:T,action:g,id:D}=f(),h=!r||r===T?t!=null?t:D:t,[P,b]=Bo.default.useState(h),M=r!=null?r:T,S=(ct=e!=null?e:g)!=null?ct:"create",L=q()(M),{mutationMode:N}=te(),K=p!=null?p:N,_=S==="create",A=S==="edit",U=S==="clone",G=s!=null?s:"list",F=P!==void 0&&(A||U),Qe=Ve({resource:L.name,id:P!=null?P:"",queryOptions:{enabled:F,...C},liveMode:x,onLiveEvent:R,liveParams:y,metaData:d,dataProviderName:u}),{isFetching:fe}=Qe,ae=we(),{mutate:nt,isLoading:Ue}=ae,ye=xt(),{mutate:Te,isLoading:it}=ye,{setWarnWhen:se}=ke(),Be=sr();return{..._||U?{formLoading:fe||Ue,mutationResult:ae,onFinish:async ee=>{se(!1);let ne=ie=>{Be({redirect:G,resource:L,id:ie})};return K!=="pessimistic"&&setTimeout(()=>{ne()}),new Promise((ie,V)=>(K!=="pessimistic"&&ie(),nt({values:ee,resource:L.name,successNotification:n,errorNotification:m,metaData:d,dataProviderName:u,invalidates:l},{onSuccess:(H,me,Ce)=>{var Cr;a&&a(H,ee,Ce);let Re=(Cr=H==null?void 0:H.data)==null?void 0:Cr.id;ne(Re),ie(H)},onError:(H,me,Ce)=>{if(o)return o(H,ee,Ce);V()}})))}}:{formLoading:fe||it,mutationResult:ye,onFinish:async ee=>{se(!1);let ne={id:P!=null?P:"",values:ee,resource:L.name,mutationMode:K,undoableTimeout:i,successNotification:n,errorNotification:m,metaData:d,dataProviderName:u,invalidates:l},ie=()=>{b(h),Be({redirect:G,resource:L,id:P})};return K!=="pessimistic"&&setTimeout(()=>{ie()}),new Promise((V,H)=>(K!=="pessimistic"&&V(),setTimeout(()=>{Te(ne,{onSuccess:(me,Ce,Re)=>{a&&a(me,ee,Re),K==="pessimistic"&&ie(),V(me)},onError:(me,Ce,Re)=>{if(o)return o(me,ee,Re);H()}})})))}},queryResult:Qe,id:P,setId:b,redirect:(ee,ne)=>{Be({redirect:ee!==void 0?ee:A?"list":"edit",resource:L,id:ne!=null?ne:P})}}};var Ao=require("react");var sr=()=>{let{show:e,edit:r,list:t,create:a}=J();return(0,Ao.useCallback)(({redirect:s,resource:n,id:m})=>{if(s&&n.route)return n.canShow&&s==="show"&&m?e(n.route,m):n.canEdit&&s==="edit"&&m?r(n.route,m):n.canCreate&&s==="create"?a(n.route):t(n.route,"push")},[])};var J=()=>{let{useHistory:e}=I(),r=e(),t=q(),a=(f,T="push")=>{T==="push"?r.push(f):r.replace(f)},o=f=>`/${t(f).route}/create`,s=(f,T)=>{let g=t(f),D=encodeURIComponent(T);return`/${g.route}/edit/${D}`},n=(f,T)=>{let g=t(f),D=encodeURIComponent(T);return`/${g.route}/clone/${D}`},m=(f,T)=>{let g=t(f),D=encodeURIComponent(T);return`/${g.route}/show/${D}`},d=f=>`/${t(f).route}`;return{create:(f,T="push")=>{a(o(f),T)},createUrl:o,edit:(f,T,g="push")=>{a(s(f,T),g)},editUrl:s,clone:(f,T,g="push")=>{a(n(f,T),g)},cloneUrl:n,show:(f,T,g="push")=>{a(m(f,T),g)},showUrl:m,list:(f,T="push")=>{a(d(f),T)},listUrl:d,push:(f,T)=>{r.push(f,T)},replace:(f,T)=>{r.replace(f,T)},goBack:()=>{r.goBack()}}};var Vo=require("react");var Pa=({resource:e,id:r,successNotification:t,errorNotification:a,metaData:o,liveMode:s,onLiveEvent:n,dataProviderName:m}={})=>{let{useParams:d}=I(),{resource:p,id:x}=d(),R=!e||e===p?r!=null?r:x:r,[y,i]=(0,Vo.useState)(R),l=q()(e!=null?e:p);return{queryResult:Ve({resource:l.name,id:y!=null?y:"",queryOptions:{enabled:y!==void 0},successNotification:t,errorNotification:a,metaData:o,liveMode:s,onLiveEvent:n,dataProviderName:m}),showId:y,setShowId:i}};var He=require("react"),No=require("papaparse"),Ko=v(require("lodash/chunk"));var va=({resourceName:e,mapData:r=m=>m,paparseOptions:t,batchSize:a=Number.MAX_SAFE_INTEGER,onFinish:o,metaData:s,onProgress:n}={})=>{let[m,d]=(0,He.useState)(0),[p,x]=(0,He.useState)(0),[R,y]=(0,He.useState)(!1),i=q(),{useParams:u}=I(),{resource:l}=u(),{name:C}=i(e!=null?e:l),f=Dt(),T=we(),g;a===1?g=T:g=f;let D=()=>{x(0),d(0),y(!1)},h=b=>{let M={succeeded:b.filter(S=>S.type==="success"),errored:b.filter(S=>S.type==="error")};o==null||o(M),y(!1)};(0,He.useEffect)(()=>{n==null||n({totalAmount:p,processedAmount:m})},[p,m]);let P=({file:b})=>(D(),new Promise(M=>{y(!0),(0,No.parse)(b,{complete:async({data:S})=>{let B=Ge(S,r);if(x(B.length),a===1){let L=await Promise.all(B.map(N=>({response:T.mutateAsync({resource:C,values:N,successNotification:!1,errorNotification:!1,metaData:s}),value:N})).map(({response:N,value:K})=>N.then(({data:_})=>(d(A=>A+1),{response:[_],type:"success",request:[K]})).catch(_=>({response:[_],type:"error",request:[K]}))));M(L)}else{let L=await Promise.all((0,Ko.default)(B,a).map(N=>({response:f.mutateAsync({resource:C,values:N,successNotification:!1,errorNotification:!1,metaData:s}),currentBatchLength:N.length,value:N})).map(({response:N,value:K,currentBatchLength:_})=>N.then(A=>(d(U=>U+_),{response:A.data,type:"success",request:K})).catch(A=>({response:[A],type:"error",request:K}))));M(L)}},...t})}).then(M=>(h(M),M)));return{inputProps:{type:"file",accept:".csv",onChange:b=>{b.target.files&&b.target.files.length>0&&P({file:b.target.files[0]})}},mutationResult:g,isLoading:R,handleChange:P}};var rt=require("react"),ba=({defaultVisible:e=!1}={})=>{let[r,t]=(0,rt.useState)(e),a=(0,rt.useCallback)(()=>t(!0),[r]),o=(0,rt.useCallback)(()=>t(!1),[r]);return{visible:r,show:a,close:o}};var ko=require("react");var nr=v(require("react")),ha={useHistory:()=>!1,useLocation:()=>!1,useParams:()=>({}),Prompt:()=>null,Link:()=>null},ot=nr.default.createContext(ha),wo=({children:e,useHistory:r,useLocation:t,useParams:a,Prompt:o,Link:s,routes:n})=>nr.default.createElement(ot.Provider,{value:{useHistory:r,useLocation:t,useParams:a,Prompt:o,Link:s,routes:n}},e);var I=()=>{let{useHistory:e,useLocation:r,useParams:t,Prompt:a,Link:o,routes:s}=(0,ko.useContext)(ot);return{useHistory:e,useLocation:r,useParams:t,Prompt:a,Link:o,routes:s}};var Ho=require("react"),$o=require("react-query");var ir=v(require("react"));var Me=ir.default.createContext({}),Fo=({can:e,children:r})=>ir.default.createElement(Me.Provider,{value:{can:e}},r);var ur=({action:e,resource:r,params:t,queryOptions:a})=>{let{can:o}=(0,Ho.useContext)(Me),s=(0,$o.useQuery)(["useCan",{action:e,resource:r,params:t}],()=>{var n;return(n=o==null?void 0:o({action:e,resource:r,params:t}))!=null?n:{can:!0}},{enabled:typeof o<"u",...a,retry:!1});return typeof o>"u"?{data:{can:!0}}:s};var Wo=require("react");var Ma=()=>{let{can:e}=(0,Wo.useContext)(Me);return{can:e}};var $e=require("react"),Oo=v(require("lodash/uniqBy")),Go=v(require("lodash/debounce"));var Ea=e=>{let[r,t]=(0,$e.useState)([]),[a,o]=(0,$e.useState)([]),[s,n]=(0,$e.useState)([]),{resource:m,sort:d,filters:p=[],optionLabel:x="title",optionValue:R="id",debounce:y=300,successNotification:i,errorNotification:u,defaultValueQueryOptions:l,queryOptions:C,fetchSize:f,liveMode:T,defaultValue:g=[],onLiveEvent:D,onSearch:h,liveParams:P,metaData:b,dataProviderName:M}=e,S=Array.isArray(g)?g:[g],B=U=>{n(U.data.map(G=>({label:G[x],value:G[R]})))},L=l!=null?l:C,N=Tt({resource:m,ids:S,queryOptions:{enabled:S.length>0,...L,onSuccess:U=>{var G;B(U),(G=L==null?void 0:L.onSuccess)==null||G.call(L,U)}},metaData:b,liveMode:"off",dataProviderName:M}),K=U=>{o(U.data.map(G=>({label:G[x],value:G[R]})))},_=Ae({resource:m,config:{sort:d,filters:p.concat(r),pagination:f?{pageSize:f}:void 0},queryOptions:{...C,onSuccess:U=>{var G;K(U),(G=C==null?void 0:C.onSuccess)==null||G.call(C,U)}},successNotification:i,errorNotification:u,metaData:b,liveMode:T,liveParams:P,onLiveEvent:D,dataProviderName:M}),A=U=>{if(!U){t([]);return}t(h?h(U):[{field:x,operator:"contains",value:U}])};return{queryResult:_,defaultValueQueryResult:N,options:(0,$e.useMemo)(()=>(0,Oo.default)([...a,...s],"value"),[a,s]),onSearch:(0,Go.default)(A,y)}};var ue=require("react"),cr=v(require("lodash/differenceWith")),pr=v(require("lodash/isEqual"));var La=[],Ia=[];function Sa({initialCurrent:e=1,initialPageSize:r=10,hasPagination:t=!0,initialSorter:a,permanentSorter:o=Ia,defaultSetFilterBehavior:s="merge",initialFilter:n,permanentFilter:m=La,syncWithLocation:d,resource:p,successNotification:x,errorNotification:R,queryOptions:y,liveMode:i,onLiveEvent:u,liveParams:l,metaData:C,dataProviderName:f}={}){var ie;let{syncWithLocation:T}=Ut(),g=d!=null?d:T,{useLocation:D,useParams:h}=I(),{search:P,pathname:b}=D(),M=er(i),{parsedCurrent:S,parsedPageSize:B,parsedSorter:L,parsedFilters:N}=_e(P),K=S||e,_=B||r,A=L.length?L:a,U=N.length?N:n,{resource:G}=h(),{push:F}=J(),fe=q()(p!=null?p:G),[ae,nt]=(0,ue.useState)(je(o,A!=null?A:[])),[Ue,ye]=(0,ue.useState)(Ye(m,U!=null?U:[])),[Te,it]=(0,ue.useState)(K),[se,Be]=(0,ue.useState)(_),mr=({pagination:{current:V,pageSize:H},sorter:me,filters:Ce})=>{let Re=qe({pagination:{pageSize:H,current:V},sorter:me,filters:Ce});return`${b}?${Re}`};(0,ue.useEffect)(()=>{P===""&&(it(K),Be(_),nt(je(o,A!=null?A:[])),ye(Ye(m,U!=null?U:[])))},[P]),(0,ue.useEffect)(()=>{if(g){let V=qe({...t?{pagination:{pageSize:se,current:Te}}:{},sorter:(0,cr.default)(ae,o,pr.default),filters:(0,cr.default)(Ue,m,pr.default)});return F(`${b}?${V}`)}},[g,Te,se,ae,Ue]);let ut=Ae({resource:fe.name,config:{hasPagination:t,pagination:{current:Te,pageSize:se},filters:Pe(m,Ue),sort:Je(o,ae)},queryOptions:y,successNotification:x,errorNotification:R,metaData:C,liveMode:M,liveParams:l,onLiveEvent:u,dataProviderName:f}),fr=V=>{ye(H=>Pe(m,V,H))},yr=V=>{ye(Pe(m,V))},Tr=V=>{ye(H=>Pe(m,V(H)))},ct=(V,H=s)=>{typeof V=="function"?Tr(V):H==="replace"?yr(V):fr(V)},ee=V=>{nt(()=>Je(o,V))},ne=(0,ue.useMemo)(()=>{var V,H;return t?{current:Te,setCurrent:it,pageSize:se,setPageSize:Be,pageCount:se?Math.ceil(((H=(V=ut.data)==null?void 0:V.total)!=null?H:0)/se):1}:{current:void 0,setCurrent:void 0,pageSize:void 0,setPageSize:void 0,pageCount:void 0}},[t,Te,se,(ie=ut.data)==null?void 0:ie.total]);return{tableQueryResult:ut,sorter:ae,setSorter:ee,filters:Ue,setFilters:ct,...ne,createLinkForSyncWithLocation:mr}}var lr=require("react"),at=require("react-query");var dr=v(require("react")),Ee=dr.default.createContext({}),zo=({create:e,get:r,update:t,children:a})=>dr.default.createElement(Ee.Provider,{value:{create:e,get:r,update:t}},a);var ve=()=>{let e=(0,at.useQueryClient)(),r=(0,lr.useContext)(Ee),{resources:t}=(0,lr.useContext)(be),{data:a,refetch:o,isLoading:s}=dt({queryOptions:{enabled:!!r}}),n=(0,at.useMutation)(async d=>{var y,i,u;let p=t.find(l=>l.name===d.resource),x=(i=(y=p==null?void 0:p.options)==null?void 0:y.auditLog)==null?void 0:i.permissions;if(x&&!Ht(x,d.action))return;let R;return s&&(R=await o()),await((u=r.create)==null?void 0:u.call(r,{...d,author:a!=null?a:R==null?void 0:R.data}))}),m=(0,at.useMutation)(async d=>{var p;return await((p=r.update)==null?void 0:p.call(r,d))},{onSuccess:d=>{if(d!=null&&d.resource){let p=w(d==null?void 0:d.resource);e.invalidateQueries(p.logList())}}});return{log:n,rename:m}};var _o=require("react"),qo=require("react-query");var Qa=({resource:e,action:r,meta:t,author:a,metaData:o,queryOptions:s})=>{let{get:n}=(0,_o.useContext)(Ee),m=w(e,void 0,o);return(0,qo.useQuery)(m.logList(t),()=>{var p;return(p=n==null?void 0:n({resource:e,action:r,author:a,meta:t,metaData:o}))!=null?p:Promise.resolve([])},{enabled:typeof n<"u",...s,retry:!1})};var Jo=require("react"),Yo=require("react-query");var Z=()=>{let e=(0,Yo.useQueryClient)();return(0,Jo.useCallback)(({resource:t,dataProviderName:a,invalidates:o,id:s})=>{if(o===!1)return;let n=w(t,a);o.forEach(m=>{switch(m){case"all":e.invalidateQueries(n.all);break;case"list":e.invalidateQueries(n.list());break;case"many":e.invalidateQueries(n.many());break;case"resourceAll":e.invalidateQueries(n.resourceAll);break;case"detail":e.invalidateQueries(n.detail(s||""));break;default:break}})},[])};var jo=require("react"),st=v(require("humanize-string")),Xo=v(require("warn-once"));var Ua=()=>{var d;let{useParams:e}=I(),{i18nProvider:r}=(0,jo.useContext)(oe),t=E(),{resources:a,resource:o}=he(),{action:s}=e(),n=[];if(!(o!=null&&o.name))return{breadcrumbs:n};let m=p=>{var R;let x=a.find(y=>y.name===p);x&&(x.parentName&&m(x.parentName),n.push({label:(R=x.label)!=null?R:t(`${x.name}.${x.name}`,(0,st.default)(x.name)),href:x.list?`/${x.route}`:void 0,icon:x.icon}))};if(o.parentName&&m(o.parentName),n.push({label:(d=o.label)!=null?d:t(`${o.name}.${o.name}`,(0,st.default)(o.name)),href:o.list?`/${o.route}`:void 0,icon:o.icon}),s){let p=`actions.${s}`,x=t(p);typeof r<"u"&&x===p?((0,Xo.default)(!0,`[useBreadcrumb]: Breadcrumb missing translate key for the "${s}" action. Please add "actions.${s}" key to your translation file.
For more information, see https://refine.dev/docs/core/hooks/useBreadcrumb/#i18n-support`),n.push({label:t(`buttons.${s}`,(0,st.default)(s))})):n.push({label:t(p,(0,st.default)(s))})}return{breadcrumbs:n}};var Le=v(require("react"));var Zo=()=>{let{resources:e}=he(),r=E(),{useLocation:t,useParams:a}=I(),o=t(),s=a(),{hasDashboard:n}=Fe(),m=Le.default.useMemo(()=>{let i=e.find(l=>(o==null?void 0:o.pathname)===`/${l.route}`);i||(i=e.find(l=>(s==null?void 0:s.resource)===l.route));let u;return i!=null&&i.route?u=`/${i==null?void 0:i.route}`:o.pathname==="/"?u="/":u=o==null?void 0:o.pathname,u},[e,o,s]),d=Le.default.useMemo(()=>e.map(i=>{var l,C;let u=`/${i.route}`;return{...i,icon:i.icon,route:u,key:(l=i.key)!=null?l:u,label:(C=i.label)!=null?C:r(`${i.name}.${i.name}`,xe(i.name,"plural"))}}),[e,n]),p=Le.default.useMemo(()=>ze(d),[d]),x=Le.default.useCallback((i,u,l=!1)=>{let C=u.find(f=>l?f.name===i:f.route===i);if(C){let f=[];return l&&C.route&&f.unshift(C.route),C.parentName&&f.unshift(...x(C.parentName,u,!0)),f}return[]},[]),R=Le.default.useMemo(()=>x(m,d),[m,d]);return Le.default.useMemo(()=>{let i=u=>u.reduce((l,C)=>C.children.length>0?[...l,{...C,children:i(C.children)}]:typeof C.list<"u"?[...l,C]:l,[]);return{defaultOpenKeys:R,selectedKey:m,menuItems:i(p)}},[R,m,p])};var ea=()=>{let[e,r]=(0,ce.useState)(),{push:t}=J(),a=E(),o=["edit","create","show"],{useParams:s}=I(),n=s(),m=q();return(0,ce.useEffect)(()=>{if(n.resource){let d=m(n.resource);n.action&&o.includes(n.action)&&!d[n.action]&&r(a("pages.error.info",{action:n.action,resource:n.resource},`You may have forgotten to add the "${n.action}" component to "${n.resource}" resource.`))}},[n]),ce.default.createElement(ce.default.Fragment,null,ce.default.createElement("h1",null,a("pages.error.404",void 0,"Sorry, the page you visited does not exist.")),e&&ce.default.createElement("p",null,e),ce.default.createElement("button",{onClick:()=>t("/")},a("pages.error.backHome",void 0,"Back Home")))};var W=v(require("react"));var ht=()=>{let[e,r]=(0,W.useState)(""),[t,a]=(0,W.useState)(""),o=E(),{mutate:s}=mt();return W.default.createElement(W.default.Fragment,null,W.default.createElement("h1",null,o("pages.login.title","Sign in your account")),W.default.createElement("form",{onSubmit:n=>{n.preventDefault(),s({username:e,password:t})}},W.default.createElement("table",null,W.default.createElement("tbody",null,W.default.createElement("tr",null,W.default.createElement("td",null,o("pages.login.username",void 0,"username"),":"),W.default.createElement("td",null,W.default.createElement("input",{type:"text",size:20,autoCorrect:"off",spellCheck:!1,autoCapitalize:"off",autoFocus:!0,required:!0,value:e,onChange:n=>r(n.target.value)}))),W.default.createElement("tr",null,W.default.createElement("td",null,o("pages.login.password",void 0,"password"),":"),W.default.createElement("td",null,W.default.createElement("input",{type:"password",required:!0,size:20,value:t,onChange:n=>a(n.target.value)}))))),W.default.createElement("br",null),W.default.createElement("input",{type:"submit",value:"login"})))};var j=v(require("react")),Bt=()=>j.default.createElement(j.default.Fragment,null,j.default.createElement("h1",null,"Welcome on board"),j.default.createElement("p",null,"Your configuration is completed."),j.default.createElement("p",null,"Now you can get started by adding your resources to the"," ",j.default.createElement("code",null,"`resources`")," property of ",j.default.createElement("code",null,"`<Refine>`")),j.default.createElement("div",{style:{display:"flex",gap:8}},j.default.createElement("a",{href:"https://refine.dev",target:"_blank",rel:"noreferrer"},j.default.createElement("button",null,"Documentation")),j.default.createElement("a",{href:"https://refine.dev/docs/examples/tutorial",target:"_blank",rel:"noreferrer"},j.default.createElement("button",null,"Examples")),j.default.createElement("a",{href:"https://discord.gg/refine",target:"_blank",rel:"noreferrer"},j.default.createElement("button",null,"Community"))));var O=v(require("react")),Vt=require("react-query");var ra=require("react"),At=require("jose");var le=require("react");var Ba="3.54.0",ta=()=>{let e=(0,le.useContext)(z),r=(0,le.useContext)(Ee),t=(0,le.useContext)(de),a=(0,le.useContext)(ot),o=(0,le.useContext)(Xe),{i18nProvider:s}=(0,le.useContext)(oe),n=(0,le.useContext)(et),m=(0,le.useContext)(Me),{resources:d}=he(),p=e.isProvided,x=!!r.create||!!r.get||!!r.update,R=!!(t!=null&&t.publish)||!!(t!=null&&t.subscribe)||!!(t!=null&&t.unsubscribe),y=!!a.useHistory||!!a.Link||!!a.Prompt||!!a.useLocation||!!a.useParams,i=!!o,u=!!(s!=null&&s.changeLocale)||!!(s!=null&&s.getLocale)||!!(s!=null&&s.translate),l=!!n.close||!!n.open,C=!!m.can;return{providers:{auth:p,auditLog:x,live:R,router:y,data:i,i18n:u,notification:l,accessControl:C},version:Ba,resourceCount:d.length}};var Aa={kty:"RSA",e:"AQAB",use:"enc",alg:"RSA-OAEP-256",n:"glC_mSwk1VqaofnOPXK3HEC5njb4uHZM5_shFdQLRn_898dxVUMK7HkyOgoVOtEsNxDBjwK_KPbSEYX_lyfrJ6ONjnxPJ2_d0W_1ZwdwT_gr5ofFLz5Bm7WbVHcKDK1j5iMYsqUJbFVQ-KXzAswae2iiqzCBKLD4y-fLsIvOUGZliERMMi54hRPqVj6p0xhJEvH22jZ5rk48KJBNvjBBuLes1qk5cehirDHnh07A8Alr3Pe6Qk7xpyC_mUvMqX99JvYThyvjQMMPEXHLJY9m1g-sgHJPlMkxMoLUd5JI1v6QMLezhq2F-bNXiRgXJgT0ew3g-H_PKpWmMQmSRtgiEw"},oa=()=>{let e=ta();return(0,ra.useEffect)(()=>{typeof window>"u"||(async()=>{let r=await(0,At.importJWK)(Aa),t=await new At.CompactEncrypt(new TextEncoder().encode(JSON.stringify(e))).setProtectedHeader({alg:"RSA-OAEP-256",enc:"A256GCM"}).encrypt(r);fetch("https://telemetry.refine.dev/send",{headers:{Accept:"application/text","Content-Type":"application/text"},method:"POST",body:t})})()},[]),null};var aa=({authProvider:e,dataProvider:r,routerProvider:t,notificationProvider:a,accessControlProvider:o,auditLogProvider:s,resources:n,DashboardPage:m,ReadyPage:d,LoginPage:p,catchAll:x,children:R,liveProvider:y,i18nProvider:i,mutationMode:u="pessimistic",syncWithLocation:l=!1,warnWhenUnsavedChanges:C=!1,undoableTimeout:f=5e3,Title:T,Layout:g,Sider:D,Header:h,Footer:P,OffLayoutArea:b,reactQueryClientConfig:M,reactQueryDevtoolConfig:S,liveMode:B,onLiveEvent:L,disableTelemetry:N=!1})=>{var G;let K=new Vt.QueryClient({...M,defaultOptions:{...M==null?void 0:M.defaultOptions,queries:{refetchOnWindowFocus:!1,keepPreviousData:!0,...(G=M==null?void 0:M.defaultOptions)==null?void 0:G.queries}}}),_=typeof a=="function"?a():a!=null?a:{},A=[];if(n==null||n.map(F=>{var Qe,fe,ae;A.push({key:F.key,name:F.name,label:(Qe=F.options)==null?void 0:Qe.label,icon:F.icon,route:(ae=(fe=F.options)==null?void 0:fe.route)!=null?ae:ge(F,n),canCreate:!!F.create,canEdit:!!F.edit,canShow:!!F.show,canDelete:F.canDelete,create:F.create,show:F.show,list:F.list,edit:F.edit,options:F.options,parentName:F.parentName})}),A.length===0)return d?O.default.createElement(d,null):O.default.createElement(Bt,null);let{RouterComponent:U=O.default.Fragment}=t;return O.default.createElement(Vt.QueryClientProvider,{client:K},O.default.createElement(xo,{..._},O.default.createElement(gr,{...e!=null?e:{},isProvided:Boolean(e)},O.default.createElement(uo,{...r},O.default.createElement(co,{liveProvider:y},O.default.createElement(wo,{...t},O.default.createElement(To,{resources:A},O.default.createElement(Po,{i18nProvider:i},O.default.createElement(Fo,{...o!=null?o:{}},O.default.createElement(zo,{...s!=null?s:{}},O.default.createElement(Ot,null,O.default.createElement(lo,{mutationMode:u,warnWhenUnsavedChanges:C,syncWithLocation:l,Title:T,undoableTimeout:f,catchAll:x,DashboardPage:m,LoginPage:p,Layout:g,Sider:D,Footer:P,Header:h,OffLayoutArea:b,hasDashboard:!!m,liveMode:B,onLiveEvent:L},O.default.createElement(Mo,null,O.default.createElement(U,null,R,!N&&O.default.createElement(oa,null),O.default.createElement(Nt,null)))))))))))))))};var sa=require("react");var Gt=({notifications:e})=>{let r=E(),{notificationDispatch:t}=re(),{open:a}=pe(),o=()=>{e.forEach(s=>{s.isRunning===!0&&(s.seconds===0&&s.doMutation(),s.isSilent||a==null||a({key:`${s.id}-${s.resource}-notification`,type:"progress",message:r("notifications.undoable",{seconds:Oe(s.seconds)},`You have ${Oe(s.seconds)} seconds to undo`),cancelMutation:s.cancelMutation,undoableTimeout:Oe(s.seconds)}),s.seconds>0&&setTimeout(()=>{t({type:"DECREASE_NOTIFICATION_SECOND",payload:{id:s.id,seconds:s.seconds,resource:s.resource}})},1e3))})};return(0,sa.useEffect)(()=>{o()},[e]),null};var We=v(require("react"));var na=({children:e,Layout:r,Sider:t,Header:a,Title:o,Footer:s,OffLayoutArea:n})=>{let{Layout:m,Footer:d,Header:p,Sider:x,Title:R,OffLayoutArea:y}=Fe(),i=r!=null?r:m;return We.default.createElement(i,{Sider:t!=null?t:x,Header:a!=null?a:p,Footer:s!=null?s:d,Title:o!=null?o:R,OffLayoutArea:n!=null?n:y},e,We.default.createElement(Va,null))},Va=()=>{let{Prompt:e}=I(),r=E(),{warnWhen:t,setWarnWhen:a}=ke(),o=s=>(s.preventDefault(),s.returnValue=r("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes."),s.returnValue);return(0,We.useEffect)(()=>(t&&window.addEventListener("beforeunload",o),window.removeEventListener("beforeunload",o)),[t]),We.default.createElement(e,{when:t,message:r("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes."),setWarnWhen:a})};var Ie=v(require("react"));var ia=({children:e,fallback:r,loading:t})=>{let{isSuccess:a,isLoading:o,isError:s}=ft(),{replace:n}=J(),{useLocation:m}=I(),{pathname:d,search:p}=m();if(o)return Ie.default.createElement(Ie.default.Fragment,null,t)||null;if(s){if(!r){let x=`${d}${p}`;return d.includes("/login")||n(`/login?to=${encodeURIComponent(x)}`),null}return Ie.default.createElement(Ie.default.Fragment,null,r)}return a?Ie.default.createElement(Ie.default.Fragment,null,e):null};var Kt=require("react");var Nt=()=>{let{useLocation:e}=I(),{checkAuth:r}=(0,Kt.useContext)(z),t=e();return(0,Kt.useEffect)(()=>{r==null||r().catch(()=>!1)},[t==null?void 0:t.pathname]),null};var Se=v(require("react"));var ua=({resource:e,action:r,params:t,fallback:a,children:o,...s})=>{let{data:n}=ur({resource:e,action:r,params:t});return n!=null&&n.can?Se.default.isValidElement(o)?Se.default.cloneElement(o,s):Se.default.createElement(Se.default.Fragment,null,o):(n==null?void 0:n.can)===!1?Se.default.createElement(Se.default.Fragment,null,a!=null?a:null):null};
//# sourceMappingURL=index.js.map