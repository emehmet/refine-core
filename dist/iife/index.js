(()=>{var Wo=Object.create;var dr=Object.defineProperty;var Fo=Object.getOwnPropertyDescriptor;var Oo=Object.getOwnPropertyNames;var Go=Object.getPrototypeOf,_o=Object.prototype.hasOwnProperty;var y=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(r,t)=>(typeof require!="undefined"?require:r)[t]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var zo=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Oo(r))!_o.call(e,o)&&o!==t&&dr(e,o,{get:()=>r[o],enumerable:!(n=Fo(r,o))||n.enumerable});return e};var h=(e,r,t)=>(t=e!=null?Wo(Go(e)):{},zo(r||!e||!e.__esModule?dr(t,"default",{value:e,enumerable:!0}):t,e));var ce=h(y("react"));var yr=y("react");var Et=h(y("react")),mr=y("react-query");var G=Et.default.createContext({}),fr=({children:e,isProvided:r,...t})=>{let{replace:n}=j(),o=(0,mr.useQueryClient)(),s=()=>{o.invalidateQueries(["useAuthenticated"]),o.invalidateQueries(["getUserIdentity"]),o.invalidateQueries(["usePermissions"])},a=async c=>{var R;try{let x=await((R=t.login)==null?void 0:R.call(t,c));return Promise.resolve(x)}catch(x){return Promise.reject(x)}finally{s()}},d=async c=>{var R;try{let x=await((R=t.logout)==null?void 0:R.call(t,c));return Promise.resolve(x)}catch(x){return Promise.reject(x)}finally{s()}},p=async c=>{var R;try{return await((R=t.checkAuth)==null?void 0:R.call(t,c)),Promise.resolve()}catch(x){return x!=null&&x.redirectPath&&n(x.redirectPath),Promise.reject(x)}finally{s()}};return Et.default.createElement(G.Provider,{value:{...t,login:a,logout:d,checkAuth:p,isProvided:r}},e)};var Cr=y("react-query"),qo=e=>{let{getPermissions:r}=(0,yr.useContext)(G);return(0,Cr.useQuery)(["usePermissions"],r!=null?r:()=>Promise.resolve(void 0),{enabled:!!r,...e})};var Tr=h(y("react")),xr=y("react-query");var Mt=({queryOptions:e}={})=>{let{getUserIdentity:r}=Tr.default.useContext(G);return(0,xr.useQuery)(["getUserIdentity"],r!=null?r:()=>Promise.resolve(void 0),{enabled:!!r,retry:!1})};var Rr=h(y("react")),gr=y("react-query");var St=()=>{let{push:e}=j(),{logout:r}=Rr.default.useContext(G),{open:t}=me();return(0,gr.useMutation)("useLogout",r,{onSuccess:o=>{o!==!1&&e(o||"/login")},onError:o=>{t==null||t({key:"useLogout-error",type:"error",message:(o==null?void 0:o.name)||"Logout Error",description:(o==null?void 0:o.message)||"Something went wrong during logout"})}})};var Dr=h(y("react")),br=y("react-query"),hr=h(y("qs"));var It=()=>{let{replace:e}=j(),{login:r}=Dr.default.useContext(G),{useLocation:t}=L(),{search:n}=t(),{close:o,open:s}=me(),{to:a}=hr.default.parse(n==null?void 0:n.substring(1));return(0,br.useMutation)("useLogin",r,{onSuccess:p=>{if(a)return e(a);p!==!1&&e(p||"/"),o==null||o("login-error")},onError:p=>{s==null||s({message:(p==null?void 0:p.name)||"Login Error",description:(p==null?void 0:p.message)||"Invalid credentials",key:"login-error",type:"error"})}})};var vr=y("react"),Pr=y("react-query");var Lt=e=>{let{checkAuth:r}=(0,vr.useContext)(G);return(0,Pr.useQuery)(["useAuthenticated",e],async()=>{await(r==null?void 0:r(e))},{retry:!1})};var Er=h(y("react")),Mr=y("react-query");var _=()=>{let{checkError:e}=Er.default.useContext(G),{mutate:r}=St();return(0,Mr.useMutation)("useCheckError",e,{onError:n=>{r({redirectPath:n})}})};var Sr=y("react");var Jo=()=>{let{isProvided:e}=(0,Sr.useContext)(G);return e||!1};var Ar=y("react-query");var Ke=e=>e/1e3;var Ir=h(y("lodash/zip")),Lr=h(y("lodash/fromPairs")),ot=(e,r=t=>t)=>{let[t,...n]=e;return n.map(o=>(0,Lr.default)((0,Ir.default)(t,o))).map((o,s,a)=>r.call(void 0,o,s,a))};var Ur=h(y("humanize-string")),Ut=h(y("pluralize")),Se=(e="",r)=>{let t=(0,Ur.default)(e);return r==="singular"?Ut.default.singular(t):Ut.default.plural(t)};var Qr=(e={})=>e!=null&&e.id?{...e,id:decodeURIComponent(e.id)}:e;var k=(e,r,t)=>{let n=r||"default",o={all:[n],resourceAll:[n,e||""],list:s=>[...o.resourceAll,"list",{...s,...t}],many:s=>[...o.resourceAll,"getMany",s&&s.map(String),{...t}].filter(a=>a!==void 0),detail:s=>[...o.resourceAll,"detail",s==null?void 0:s.toString(),{...t}],logList:s=>["logList",e,s,t].filter(a=>a!==void 0)};return o};var Qt=(e,r)=>!e||!r?!1:!!e.find(t=>t===r);var Ie=(e,r)=>{let t;if(e.parentName){let n=r.find(o=>o.name===e.parentName);n!=null&&n.parentName?(t=`${Ie(n,r)}/${e.name}`,Ie(n,r)):e.parentName&&(t=`${e.parentName}/${e.name}`)}else t=e.name;return t};var nt=e=>{var a,d,p;let r=[],t={},n={},o,s;for(let c=0;c<e.length;c++){o=e[c];let R=(p=(d=o.route)!=null?d:(a=o.options)==null?void 0:a.route)!=null?p:"";t[R]=o,t[R].children=[],n[o.name]=o,n[o.name].children=[]}for(let c in t)t.hasOwnProperty(c)&&(s=t[c],s.parentName&&n[s.parentName]?n[s.parentName].children.push(s):r.push(s));return r};var He=({resource:e,config:r,queryOptions:t,successNotification:n,errorNotification:o,metaData:s,liveMode:a,onLiveEvent:d,liveParams:p,dataProviderName:c})=>{let R=Q(),x=k(e,c,s),{getList:f}=R(c),i=M(),{mutate:u}=_(),l=K(),T=(t==null?void 0:t.enabled)===void 0||(t==null?void 0:t.enabled)===!0;return Le({resource:e,types:["*"],params:{metaData:s,pagination:r==null?void 0:r.pagination,hasPagination:r==null?void 0:r.hasPagination,sort:r==null?void 0:r.sort,filters:r==null?void 0:r.filters,subscriptionType:"useList",...p},channel:`resources/${e}`,enabled:T,liveMode:a,onLiveEvent:d}),(0,Ar.useQuery)(x.list(r),()=>{let{hasPagination:C,...g}=r||{};return f({resource:e,...g,hasPagination:C,metaData:s})},{...t,onSuccess:C=>{var D;(D=t==null?void 0:t.onSuccess)==null||D.call(t,C);let g=typeof n=="function"?n(C,{metaData:s,config:r},e):n;l(g)},onError:C=>{var D;u(C),(D=t==null?void 0:t.onError)==null||D.call(t,C);let g=typeof o=="function"?o(C,{metaData:s,config:r},e):o;l(g,{key:`${e}-useList-notification`,message:i("common:notifications.error",{statusCode:C.statusCode},`Error (status code: ${C.statusCode})`),description:C.message,type:"error"})}})};var Nr=y("react-query");var st=h(y("qs")),At=h(y("lodash/unionWith")),Bt=h(y("lodash/differenceWith")),at=e=>{let{current:r,pageSize:t,sorter:n,filters:o}=st.default.parse(e.substring(1));return{parsedCurrent:r&&Number(r),parsedPageSize:t&&Number(t),parsedSorter:n!=null?n:[],parsedFilters:o!=null?o:[]}},Yo=e=>{let r=st.default.stringify(e);return at(`/${r}`)},it=e=>{let r={skipNulls:!0,arrayFormat:"indices",encode:!1},{pagination:t,sorter:n,filters:o}=e;return st.default.stringify({...t||{},sorter:n,filters:o},r)},Br=(e,r)=>("field"in e?e.field:void 0)==("field"in r?r.field:void 0)&&e.operator==r.operator,Vr=(e,r)=>e.field==r.field,Ue=(e,r,t=[])=>(0,At.default)(e,r,t,Br).filter(n=>n.value!==void 0&&n.value!==null&&(n.operator!=="or"||n.operator==="or"&&n.value.length!==0)),ut=(e,r)=>(0,At.default)(e,r,Vr).filter(t=>t.order!==void 0&&t.order!==null),ct=(e,r)=>[...(0,Bt.default)(r,e,Br),...e],pt=(e,r)=>[...(0,Bt.default)(r,e,Vr),...e],jo=(e,r)=>{if(!r)return;let t=r.find(n=>n.field===e);if(t)return t.order},Xo=(e,r,t="eq")=>{let n=r==null?void 0:r.find(o=>{if(o.operator!=="or"){let{operator:s,field:a}=o;return a===e&&s===t}});if(n)return n.value||[]};var Zo=e=>new Promise((r,t)=>{let n=new FileReader,o=()=>{n.result&&(n.removeEventListener("load",o,!1),r(n.result))};n.addEventListener("load",o,!1),n.readAsDataURL(e.originFileObj),n.onerror=s=>(n.removeEventListener("load",o,!1),t(s))});var $e=({resource:e,id:r,queryOptions:t,successNotification:n,errorNotification:o,metaData:s,liveMode:a,onLiveEvent:d,liveParams:p,dataProviderName:c})=>{let R=Q(),x=k(e,c,s),{getOne:f}=R(c),i=M(),{mutate:u}=_(),l=K();return Le({resource:e,types:["*"],channel:`resources/${e}`,params:{ids:r?[r]:[],id:r,metaData:s,subscriptionType:"useOne",...p},enabled:t==null?void 0:t.enabled,liveMode:a,onLiveEvent:d}),(0,Nr.useQuery)(x.detail(r),()=>f({resource:e,id:r,metaData:s}),{...t,onSuccess:m=>{var g;(g=t==null?void 0:t.onSuccess)==null||g.call(t,m);let C=typeof n=="function"?n(m,{id:r,metaData:s},e):n;l(C)},onError:m=>{var g;u(m),(g=t==null?void 0:t.onError)==null||g.call(t,m);let C=typeof o=="function"?o(m,{id:r,metaData:s},e):o;l(C,{key:`${r}-${e}-getOne-notification`,message:i("notifications.error",{statusCode:m.statusCode},`Error (status code: ${m.statusCode})`),description:m.message,type:"error"})}})};var wr=y("react-query");var Vt=({resource:e,ids:r,queryOptions:t,successNotification:n,errorNotification:o,metaData:s,liveMode:a,onLiveEvent:d,liveParams:p,dataProviderName:c})=>{let R=Q(),x=k(e,c,s),{getMany:f}=R(c),i=M(),{mutate:u}=_(),l=K(),T=(t==null?void 0:t.enabled)===void 0||(t==null?void 0:t.enabled)===!0;return Le({resource:e,types:["*"],params:{ids:r!=null?r:[],metaData:s,subscriptionType:"useMany",...p},channel:`resources/${e}`,enabled:T,liveMode:a,onLiveEvent:d}),(0,wr.useQuery)(x.many(r),()=>f({resource:e,ids:r,metaData:s}),{...t,onSuccess:C=>{var D;(D=t==null?void 0:t.onSuccess)==null||D.call(t,C);let g=typeof n=="function"?n(C,r,e):n;l(g)},onError:C=>{var D;u(C),(D=t==null?void 0:t.onError)==null||D.call(t,C);let g=typeof o=="function"?o(C,r,e):o;l(g,{key:`${r[0]}-${e}-getMany-notification`,message:i("notifications.error",{statusCode:C.statusCode},`Error (status code: ${C.statusCode})`),description:C.message,type:"error"})}})};var dt=y("react-query");var Qe=h(y("react")),kr=y("react-dom");var lt=Qe.default.createContext({notifications:[],notificationDispatch:()=>!1}),en=[],tn=(e,r)=>{switch(r.type){case"ADD":return[...e.filter(t=>t.id!=r.payload.id&&t.resource==r.payload.resource),{...r.payload,isRunning:!0}];case"REMOVE":return e.filter(t=>t.id!=r.payload.id&&t.resource==r.payload.resource);case"DECREASE_NOTIFICATION_SECOND":return e.map(t=>t.id==r.payload.id&&t.resource==r.payload.resource?{...t,seconds:r.payload.seconds-1e3}:t);default:return e}},Nt=({children:e})=>{let[r,t]=(0,Qe.useReducer)(tn,en),n={notifications:r,notificationDispatch:t};return Qe.default.createElement(lt.Provider,{value:n},e,typeof window<"u"&&(0,kr.createPortal)(Qe.default.createElement(Kr,{notifications:r}),document.body))};var wt=h(y("pluralize"));var kt=()=>{let e=(0,dt.useQueryClient)(),r=Q(),{mutationMode:t,undoableTimeout:n}=te(),o=M(),{mutate:s}=_(),a=Z(),{log:d}=Be(),{notificationDispatch:p}=ie(),c=K(),R=ee();return(0,dt.useMutation)(({id:f,values:i,resource:u,mutationMode:l,undoableTimeout:T,onCancel:m,metaData:C,dataProviderName:g})=>{let D=l!=null?l:t,P=T!=null?T:n;return D!=="undoable"?r(g).update({resource:u,id:f,variables:i,metaData:C}):new Promise((v,E)=>{let I=()=>{r(g).update({resource:u,id:f,variables:i,metaData:C}).then(S=>v(S)).catch(S=>E(S))},A=()=>{E({message:"mutationCancelled"})};m&&m(A),p({type:"ADD",payload:{id:f,resource:u,cancelMutation:A,doMutation:I,seconds:P,isSilent:!!m}})})},{onMutate:async({resource:f,id:i,mutationMode:u,values:l,dataProviderName:T})=>{let m=k(f,T),C=e.getQueriesData(m.resourceAll),g=u!=null?u:t;return await e.cancelQueries(m.resourceAll,void 0,{silent:!0}),g!=="pessimistic"&&(e.setQueriesData(m.list(),D=>{if(!D)return null;let P=D.data.map(b=>{var v;return((v=b.id)==null?void 0:v.toString())===(i==null?void 0:i.toString())?{id:i,...l}:b});return{...D,data:P}}),e.setQueriesData(m.many(),D=>{if(!D)return null;let P=D.data.map(b=>{var v;return((v=b.id)==null?void 0:v.toString())===(i==null?void 0:i.toString())&&(b={id:i,...l}),b});return{...D,data:P}}),e.setQueriesData(m.detail(i),D=>D?{...D,data:{...D.data,...l}}:null)),{previousQueries:C,queryKey:m}},onSettled:(f,i,{id:u,resource:l,dataProviderName:T,invalidates:m=["list","many","detail"]})=>{R({resource:l,dataProviderName:T,invalidates:m,id:u}),p({type:"REMOVE",payload:{id:u,resource:l}})},onSuccess:(f,{id:i,resource:u,successNotification:l,dataProviderName:T,values:m,metaData:C},g)=>{var S;let D=wt.default.singular(u),P=typeof l=="function"?l(f,{id:i,values:m},u):l;c(P,{key:`${i}-${u}-notification`,description:o("notifications.success","Successful"),message:o("notifications.editSuccess",{resource:o(`${u}.${u}`,D)},`Successfully updated ${D}`),type:"success"}),a==null||a({channel:`resources/${u}`,type:"updated",payload:{ids:(S=f.data)!=null&&S.id?[f.data.id]:void 0},date:new Date});let b;if(g){let N=e.getQueryData(g.queryKey.detail(i));b=Object.keys(m).reduce((w,z)=>{var B;return w[z]=(B=N==null?void 0:N.data)==null?void 0:B[z],w},{})}let{fields:v,operation:E,variables:I,...A}=C||{};d==null||d.mutate({action:"update",resource:u,data:m,previousData:b,meta:{id:i,dataProviderName:T,...A}})},onError:(f,{id:i,resource:u,errorNotification:l,values:T},m)=>{if(m)for(let C of m.previousQueries)e.setQueryData(C[0],C[1]);if(f.message!=="mutationCancelled"){s==null||s(f);let C=wt.default.singular(u),g=typeof l=="function"?l(f,{id:i,values:T},u):l;c(g,{key:`${i}-${u}-notification`,message:o("notifications.editError",{resource:o(`${u}.${u}`,C),statusCode:f.statusCode},`Error when updating ${C} (status code: ${f.statusCode})`),description:f.message,type:"error"})}}})};var Hr=y("react-query"),Kt=h(y("pluralize"));var We=()=>{let{mutate:e}=_(),r=Q(),t=ee(),n=M(),o=Z(),{log:s}=Be(),a=K();return(0,Hr.useMutation)(({resource:p,values:c,metaData:R,dataProviderName:x})=>r(x).create({resource:p,variables:c,metaData:R}),{onSuccess:(p,{resource:c,successNotification:R,dataProviderName:x,invalidates:f=["list","many"],values:i,metaData:u})=>{var P,b,v;let l=Kt.default.singular(c),T=typeof R=="function"?R(p,i,c):R;a(T,{key:`create-${c}-notification`,message:n("notifications.createSuccess",{resource:n(`${c}.${c}`,l)},`Successfully created ${l}`),description:n("notifications.success","Success"),type:"success"}),t({resource:c,dataProviderName:x,invalidates:f}),o==null||o({channel:`resources/${c}`,type:"created",payload:{ids:(P=p==null?void 0:p.data)!=null&&P.id?[p.data.id]:void 0},date:new Date});let{fields:m,operation:C,variables:g,...D}=u||{};s==null||s.mutate({action:"create",resource:c,data:i,meta:{dataProviderName:x,id:(v=(b=p==null?void 0:p.data)==null?void 0:b.id)!=null?v:void 0,...D}})},onError:(p,{resource:c,errorNotification:R,values:x})=>{e(p);let f=Kt.default.singular(c),i=typeof R=="function"?R(p,x,c):R;a(i,{key:`create-${c}-notification`,description:p.message,message:n("notifications.createError",{resource:n(`${c}.${c}`,f),statusCode:p.statusCode},`There was an error creating ${f} (status code: ${p.statusCode})`),type:"error"})}})};var mt=y("react-query"),Ht=h(y("pluralize"));var rn=()=>{let{mutate:e}=_(),r=Q(),t=(0,mt.useQueryClient)(),{mutationMode:n,undoableTimeout:o}=te(),{notificationDispatch:s}=ie(),a=M(),d=Z(),{log:p}=Be(),c=K(),R=ee();return(0,mt.useMutation)(({id:f,mutationMode:i,undoableTimeout:u,resource:l,onCancel:T,metaData:m,dataProviderName:C,values:g})=>{let D=i!=null?i:n,P=u!=null?u:o;return D!=="undoable"?r(C).deleteOne({resource:l,id:f,metaData:m,variables:g}):new Promise((v,E)=>{let I=()=>{r(C).deleteOne({resource:l,id:f,metaData:m,variables:g}).then(S=>v(S)).catch(S=>E(S))},A=()=>{E({message:"mutationCancelled"})};T&&T(A),s({type:"ADD",payload:{id:f,resource:l,cancelMutation:A,doMutation:I,seconds:P,isSilent:!!T}})})},{onMutate:async({id:f,resource:i,mutationMode:u,dataProviderName:l})=>{let T=k(i,l),m=u!=null?u:n;await t.cancelQueries(T.resourceAll,void 0,{silent:!0});let C=t.getQueriesData(T.resourceAll);return m!=="pessimistic"&&(t.setQueriesData(T.list(),g=>g?{data:g.data.filter(P=>{var b;return((b=P.id)==null?void 0:b.toString())!==f.toString()}),total:g.total-1}:null),t.setQueriesData(T.many(),g=>{if(!g)return null;let D=g.data.filter(P=>{var b;return((b=P.id)==null?void 0:b.toString())!==(f==null?void 0:f.toString())});return{...g,data:D}})),{previousQueries:C,queryKey:T}},onSettled:(f,i,{id:u,resource:l,dataProviderName:T,invalidates:m=["list","many"]})=>{R({resource:l,dataProviderName:T,invalidates:m}),s({type:"REMOVE",payload:{id:u,resource:l}})},onSuccess:(f,{id:i,resource:u,successNotification:l,dataProviderName:T,metaData:m},C)=>{let g=Ht.default.singular(u!=null?u:"");t.removeQueries(C==null?void 0:C.queryKey.detail(i));let D=typeof l=="function"?l(f,i,u):l;c(D,{key:`${i}-${u}-notification`,description:a("notifications.success","Success"),message:a("notifications.deleteSuccess",{resource:a(`${u}.${u}`,g)},`Successfully deleted a ${g}`),type:"success"}),d==null||d({channel:`resources/${u}`,type:"deleted",payload:{ids:i?[i]:[]},date:new Date});let{fields:P,operation:b,variables:v,...E}=m||{};p==null||p.mutate({action:"delete",resource:u,meta:{id:i,dataProviderName:T,...E}}),t.removeQueries(C==null?void 0:C.queryKey.detail(i))},onError:(f,{id:i,resource:u,errorNotification:l},T)=>{if(T)for(let m of T.previousQueries)t.setQueryData(m[0],m[1]);if(f.message!=="mutationCancelled"){e(f);let m=Ht.default.singular(u!=null?u:""),C=typeof l=="function"?l(f,i,u):l;c(C,{key:`${i}-${u}-notification`,message:a("notifications.deleteError",{resource:m,statusCode:f.statusCode},`Error (status code: ${f.statusCode})`),description:f.message,type:"error"})}}})};var $r=y("react-query");var Wr=h(y("pluralize")),$t=()=>{let e=Q(),r=M(),t=Z(),n=K(),o=ee();return(0,$r.useMutation)(({resource:a,values:d,metaData:p,dataProviderName:c})=>e(c).createMany({resource:a,variables:d,metaData:p}),{onSuccess:(a,{resource:d,successNotification:p,dataProviderName:c,invalidates:R=["list","many"],values:x})=>{let f=Wr.default.plural(d),i=typeof p=="function"?p(a,x,d):p;n(i,{key:`createMany-${d}-notification`,message:r("notifications.createSuccess",{resource:r(`${d}.${d}`,d)},`Successfully created ${f}`),description:r("notifications.success","Success"),type:"success"}),o({resource:d,dataProviderName:c,invalidates:R});let u=a==null?void 0:a.data.filter(l=>(l==null?void 0:l.id)!==void 0).map(l=>l.id);t==null||t({channel:`resources/${d}`,type:"created",payload:{ids:u},date:new Date})},onError:(a,{resource:d,errorNotification:p,values:c})=>{let R=typeof p=="function"?p(a,c,d):p;n(R,{key:`createMany-${d}-notification`,description:a.message,message:r("notifications.createError",{resource:r(`${d}.${d}`,d),statusCode:a.statusCode},`There was an error creating ${d} (status code: ${a.statusCode}`),type:"error"})}})};var ft=y("react-query"),Wt=h(y("pluralize"));var on=()=>{let e=(0,ft.useQueryClient)(),r=Q(),t=M(),{mutationMode:n,undoableTimeout:o}=te(),{mutate:s}=_(),{notificationDispatch:a}=ie(),d=Z(),p=K(),c=ee();return(0,ft.useMutation)(({ids:x,values:f,resource:i,onCancel:u,mutationMode:l,undoableTimeout:T,metaData:m,dataProviderName:C})=>{let g=l!=null?l:n,D=T!=null?T:o;return g!=="undoable"?r(C).updateMany({resource:i,ids:x,variables:f,metaData:m}):new Promise((b,v)=>{let E=()=>{r(C).updateMany({resource:i,ids:x,variables:f,metaData:m}).then(A=>b(A)).catch(A=>v(A))},I=()=>{v({message:"mutationCancelled"})};u&&u(I),a({type:"ADD",payload:{id:x,resource:i,cancelMutation:I,doMutation:E,seconds:D,isSilent:!!u}})})},{onMutate:async({resource:x,ids:f,values:i,mutationMode:u,dataProviderName:l,metaData:T})=>{let m=k(x,l,T),C=u!=null?u:n;await e.cancelQueries(m.resourceAll,void 0,{silent:!0});let g=e.getQueriesData(m.resourceAll);if(C!=="pessimistic"){e.setQueriesData(m.list(),D=>{if(!D)return null;let P=D.data.map(b=>b.id!==void 0&&f.filter(v=>v!==void 0).map(String).includes(b.id.toString())?{...b,...i}:b);return{...D,data:P}}),e.setQueriesData(m.many(),D=>{if(!D)return null;let P=D.data.map(b=>b.id!==void 0&&f.filter(v=>v!==void 0).map(String).includes(b.id.toString())?{...b,...i}:b);return{...D,data:P}});for(let D of f)e.setQueriesData(m.detail(D),P=>{if(!P)return null;let b={...P.data,...i};return{...P,data:b}})}return{previousQueries:g,queryKey:m}},onSettled:(x,f,{ids:i,resource:u,dataProviderName:l})=>{c({resource:u,invalidates:["list","many"],dataProviderName:l}),i.forEach(T=>c({resource:u,invalidates:["detail"],dataProviderName:l,id:T})),a({type:"REMOVE",payload:{id:i,resource:u}})},onSuccess:(x,{ids:f,resource:i,successNotification:u,values:l})=>{let T=Wt.default.singular(i),m=typeof u=="function"?u(x,{ids:f,values:l},i):u;p(m,{key:`${f}-${i}-notification`,description:t("notifications.success","Successful"),message:t("notifications.editSuccess",{resource:t(`${i}.${i}`,i)},`Successfully updated ${T}`),type:"success"}),d==null||d({channel:`resources/${i}`,type:"updated",payload:{ids:f.map(String)},date:new Date})},onError:(x,{ids:f,resource:i,errorNotification:u,values:l},T)=>{if(T)for(let m of T.previousQueries)e.setQueryData(m[0],m[1]);if(x.message!=="mutationCancelled"){s==null||s(x);let m=Wt.default.singular(i),C=typeof u=="function"?u(x,{ids:f,values:l},i):u;p(C,{key:`${f}-${i}-updateMany-error-notification`,message:t("notifications.editError",{resource:m,statusCode:x.statusCode},`Error when updating ${m} (status code: ${x.statusCode})`),description:x.message,type:"error"})}}})};var yt=y("react-query"),Fr=h(y("pluralize"));var nn=()=>{let{mutate:e}=_(),{mutationMode:r,undoableTimeout:t}=te(),n=Q(),{notificationDispatch:o}=ie(),s=M(),a=Z(),d=K(),p=ee(),c=(0,yt.useQueryClient)();return(0,yt.useMutation)(({resource:x,ids:f,mutationMode:i,undoableTimeout:u,onCancel:l,metaData:T,dataProviderName:m,values:C})=>{let g=i!=null?i:r,D=u!=null?u:t;return g!=="undoable"?n(m).deleteMany({resource:x,ids:f,metaData:T,variables:C}):new Promise((b,v)=>{let E=()=>{n(m).deleteMany({resource:x,ids:f,metaData:T,variables:C}).then(A=>b(A)).catch(A=>v(A))},I=()=>{v({message:"mutationCancelled"})};l&&l(I),o({type:"ADD",payload:{id:f,resource:x,cancelMutation:I,doMutation:E,seconds:D,isSilent:!!l}})})},{onMutate:async({ids:x,resource:f,mutationMode:i,dataProviderName:u})=>{let l=k(f,u),T=i!=null?i:r;await c.cancelQueries(l.resourceAll,void 0,{silent:!0});let m=c.getQueriesData(l.resourceAll);if(T!=="pessimistic"){c.setQueriesData(l.list(),C=>C?{data:C.data.filter(D=>D.id&&!x.map(String).includes(D.id.toString())),total:C.total-1}:null),c.setQueriesData(l.many(),C=>{if(!C)return null;let g=C.data.filter(D=>D.id?!x.map(String).includes(D.id.toString()):!1);return{...C,data:g}});for(let C of x)c.setQueriesData(l.detail(C),g=>!g||g.data.id==C?null:{...g})}return{previousQueries:m,queryKey:l}},onSettled:(x,f,{resource:i,ids:u,dataProviderName:l,invalidates:T=["list","many"]})=>{p({resource:i,dataProviderName:l,invalidates:T}),o({type:"REMOVE",payload:{id:u,resource:i}})},onSuccess:(x,{ids:f,resource:i,successNotification:u},l)=>{f.forEach(m=>c.removeQueries(l==null?void 0:l.queryKey.detail(m)));let T=typeof u=="function"?u(x,f,i):u;d(T,{key:`${f}-${i}-notification`,description:s("notifications.success","Success"),message:s("notifications.deleteSuccess",{resource:s(`${i}.${i}`,i)},`Successfully deleted ${i}`),type:"success"}),a==null||a({channel:`resources/${i}`,type:"deleted",payload:{ids:f},date:new Date}),f.forEach(m=>c.removeQueries(l==null?void 0:l.queryKey.detail(m)))},onError:(x,{ids:f,resource:i,errorNotification:u},l)=>{if(l)for(let T of l.previousQueries)c.setQueryData(T[0],T[1]);if(x.message!=="mutationCancelled"){e(x);let T=Fr.default.singular(i),m=typeof u=="function"?u(x,f,i):u;d(m,{key:`${f}-${i}-notification`,message:s("notifications.deleteError",{resource:T,statusCode:x.statusCode},`Error (status code: ${x.statusCode})`),description:x.message,type:"error"})}}})};var sn=e=>{let r=Q(),{getApiUrl:t}=r(e);return t()};var Or=y("react-query");var an=({url:e,method:r,config:t,queryOptions:n,successNotification:o,errorNotification:s,metaData:a,dataProviderName:d})=>{let p=Q(),{custom:c}=p(d),{mutate:R}=_(),x=M(),f=K();if(c)return(0,Or.useQuery)([d,"custom",r,e,{...t,...a}],()=>c({url:e,method:r,...t,metaData:a}),{...n,onSuccess:u=>{var T;(T=n==null?void 0:n.onSuccess)==null||T.call(n,u);let l=typeof o=="function"?o(u,{...t,...a}):o;f(l)},onError:u=>{var T;R(u),(T=n==null?void 0:n.onError)==null||T.call(n,u);let l=typeof s=="function"?s(u,{...t,...a}):s;f(l,{key:`${r}-notification`,message:x("common:notifications.error",{statusCode:u.statusCode},`Error (status code: ${u.statusCode})`),description:u.message,type:"error"})}});throw Error("Not implemented custom on data provider.")};var Gr=y("react-query");var un=()=>{let e=K(),r=Q(),t=M();return(0,Gr.useMutation)(({url:o,method:s,values:a,metaData:d,dataProviderName:p,config:c})=>{let{custom:R}=r(p);if(R)return R({url:o,method:s,payload:a,metaData:d,headers:{...c==null?void 0:c.headers}});throw Error("Not implemented custom on data provider.")},{onSuccess:(o,{successNotification:s,config:a,metaData:d})=>{let p=typeof s=="function"?s(o,{...a,...d}):s;e(p)},onError:(o,{errorNotification:s,method:a,config:d,metaData:p})=>{let c=typeof s=="function"?s(o,{...d,...p}):s;e(c,{key:`${a}-notification`,message:t("common:notifications.error",{statusCode:o.statusCode},`Error (status code: ${o.statusCode})`),description:o.message,type:"error"})}})};var Ct=y("react");var Ft=h(y("react")),cn=()=>({default:{create:()=>Promise.resolve({data:{id:1}}),createMany:()=>Promise.resolve({data:[]}),deleteOne:()=>Promise.resolve({data:{id:1}}),deleteMany:()=>Promise.resolve({data:[]}),getList:()=>Promise.resolve({data:[],total:0}),getMany:()=>Promise.resolve({data:[]}),getOne:()=>Promise.resolve({data:{id:1}}),update:()=>Promise.resolve({data:{id:1}}),updateMany:()=>Promise.resolve({data:[]}),custom:()=>Promise.resolve({data:{}}),getApiUrl:()=>""}}),Fe=Ft.default.createContext(cn()),_r=({children:e,...r})=>{let t;return!r.hasOwnProperty("updateMany")||!r.hasOwnProperty("createMany")?t=r:t={default:r},Ft.default.createElement(Fe.Provider,{value:t},e)};var Q=()=>{let e=(0,Ct.useContext)(Fe);return(0,Ct.useCallback)(t=>{if(t){if(!e[t])throw new Error(`"${t}" Data provider not found`);return e[t]}if(e.default)return e.default;throw new Error('There is no "default" data provider. Please pass dataProviderName.')},[e])};var Oe=y("react"),Yr=y("react-query");var Ot=h(y("react")),pe=Ot.default.createContext(void 0),zr=({liveProvider:e,children:r})=>Ot.default.createElement(pe.Provider,{value:e},r);var _t=h(y("react"));var qr=h(y("react")),Gt=({children:e})=>qr.default.createElement("div",null,e);var J=_t.default.createContext({hasDashboard:!1,mutationMode:"pessimistic",warnWhenUnsavedChanges:!1,syncWithLocation:!1,undoableTimeout:5e3,Title:void 0,Sider:void 0,Header:void 0,Footer:void 0,Layout:Gt,OffLayoutArea:void 0,liveMode:"off",onLiveEvent:void 0}),Jr=({hasDashboard:e,mutationMode:r,warnWhenUnsavedChanges:t,syncWithLocation:n,undoableTimeout:o,children:s,DashboardPage:a,Title:d,Layout:p=Gt,Header:c,Sider:R,Footer:x,OffLayoutArea:f,LoginPage:i=zt,catchAll:u,liveMode:l="off",onLiveEvent:T})=>_t.default.createElement(J.Provider,{value:{hasDashboard:e,mutationMode:r,warnWhenUnsavedChanges:t,syncWithLocation:n,Title:d,undoableTimeout:o,Layout:p,Header:c,Sider:R,Footer:x,OffLayoutArea:f,DashboardPage:a,LoginPage:i,catchAll:u,liveMode:l,onLiveEvent:T}},s);var Le=({resource:e,params:r,channel:t,types:n,enabled:o=!0,liveMode:s,onLiveEvent:a})=>{let d=(0,Yr.useQueryClient)(),p=k(e),c=(0,Oe.useContext)(pe),{liveMode:R,onLiveEvent:x}=(0,Oe.useContext)(J),f=s!=null?s:R;(0,Oe.useEffect)(()=>{let i;return f&&f!=="off"&&o&&(i=c==null?void 0:c.subscribe({channel:t,params:{resource:e,...r},types:n,callback:u=>{f==="auto"&&d.invalidateQueries(p.resourceAll),a==null||a(u),x==null||x(u)}})),()=>{i&&(c==null||c.unsubscribe(i))}},[o])};var jr=y("react");var Xr=e=>{let{liveMode:r}=(0,jr.useContext)(J);return e!=null?e:r};var Tt=y("react");var Ci=({params:e,channel:r,types:t=["*"],enabled:n=!0,onLiveEvent:o})=>{let s=(0,Tt.useContext)(pe);(0,Tt.useEffect)(()=>{let a;return n&&(a=s==null?void 0:s.subscribe({channel:r,params:e,types:t,callback:o})),()=>{a&&(s==null||s.unsubscribe(a))}},[n])};var Zr=y("react");var Z=()=>{let e=(0,Zr.useContext)(pe);return e==null?void 0:e.publish};var to=y("react");var qt=h(y("react")),Re=qt.default.createContext({resources:[]}),eo=({resources:e,children:r})=>qt.default.createElement(Re.Provider,{value:{resources:e}},r);var Ve=({resourceName:e,resourceNameOrRouteName:r,recordItemId:t}={})=>{let{resources:n}=(0,to.useContext)(Re),o=q(),{useParams:s}=L(),a=s(),d=o(r!=null?r:a.resource),p=e!=null?e:d.name,c=t!=null?t:a.id;return{resources:n,resource:d,resourceName:p,id:c}};var xt=y("react");var q=()=>{let{resources:e}=(0,xt.useContext)(Re);return(0,xt.useCallback)(t=>{let n=e.find(o=>o.route===t);if(!n){let o=e.find(s=>s.name===t);return o!=null?o:{name:t,route:t}}return n},[e])};var ro=y("react");var ie=()=>{let{notifications:e,notificationDispatch:r}=(0,ro.useContext)(lt);return{notifications:e,notificationDispatch:r}};var no=y("react");var Rt=h(y("react"));var Ge=(0,Rt.createContext)({}),oo=({open:e,close:r,children:t})=>Rt.default.createElement(Ge.Provider,{value:{open:e,close:r}},t);var me=()=>{let{open:e,close:r}=(0,no.useContext)(Ge);return{open:e,close:r}};var so=y("react");var K=()=>{let{open:e}=me();return(0,so.useCallback)((t,n)=>{t!==!1&&(t?e==null||e(t):n&&(e==null||e(n)))},[])};var gt=y("react");var Jt=h(y("react"));var re=Jt.default.createContext({}),ao=({children:e,i18nProvider:r})=>Jt.default.createElement(re.Provider,{value:{i18nProvider:r}},e);var pn=()=>{let{i18nProvider:e}=(0,gt.useContext)(re);return(0,gt.useCallback)(r=>e==null?void 0:e.changeLocale(r),[])};var Dt=y("react");var M=()=>{let{i18nProvider:e}=(0,Dt.useContext)(re);return(0,Dt.useMemo)(()=>{function t(n,o,s){var a,d;return(d=(a=e==null?void 0:e.translate(n,o,s))!=null?a:s)!=null?d:typeof o=="string"&&typeof s>"u"?o:n}return t},[e])};var bt=y("react");var ln=()=>{let{i18nProvider:e}=(0,bt.useContext)(re);return(0,bt.useCallback)(()=>e==null?void 0:e.getLocale(),[])};var io=y("react");var te=()=>{let{mutationMode:e,undoableTimeout:r}=(0,io.useContext)(J);return{mutationMode:e,undoableTimeout:r}};var jt=y("react");var _e=h(y("react")),Yt=_e.default.createContext({}),uo=({children:e})=>{let[r,t]=(0,_e.useState)(!1);return _e.default.createElement(Yt.Provider,{value:{warnWhen:r,setWarnWhen:t}},e)};var ze=()=>{let{warnWhenUnsavedChanges:e}=(0,jt.useContext)(J),{warnWhen:r,setWarnWhen:t}=(0,jt.useContext)(Yt);return{warnWhenUnsavedChanges:e,warnWhen:Boolean(r),setWarnWhen:t!=null?t:()=>{}}};var co=y("react");var Xt=()=>{let{syncWithLocation:e}=(0,co.useContext)(J);return{syncWithLocation:e}};var po=y("react");var dn=()=>{let{Title:e}=(0,po.useContext)(J);return e};var lo=y("react");var qe=()=>{let{Footer:e,Header:r,Layout:t,OffLayoutArea:n,Sider:o,Title:s,hasDashboard:a,mutationMode:d,syncWithLocation:p,undoableTimeout:c,warnWhenUnsavedChanges:R,DashboardPage:x,LoginPage:f,catchAll:i}=(0,lo.useContext)(J);return{Footer:e,Header:r,Layout:t,OffLayoutArea:n,Sider:o,Title:s,hasDashboard:a,mutationMode:d,syncWithLocation:p,undoableTimeout:c,warnWhenUnsavedChanges:R,DashboardPage:x,LoginPage:f,catchAll:i}};var mo=y("react");var fo=y("export-to-csv-fix-source-map"),Uu=({resourceName:e,sorter:r,filters:t,maxItemCount:n,pageSize:o=20,mapData:s=R=>R,exportOptions:a,metaData:d,dataProviderName:p,onError:c}={})=>{let[R,x]=(0,mo.useState)(!1),f=q(),i=Q(),{useParams:u}=L(),{resource:l}=u(),{name:T}=f(l);e&&(T=e);let m=`${Se(T,"plural")}-${new Date().toLocaleString()}`,{getList:C}=i(p);return{isLoading:R,triggerExport:async()=>{x(!0);let D=[],P=1,b=!0;for(;b;)try{let{data:E,total:I}=await C({resource:T,filters:t,sort:r,pagination:{current:P,pageSize:o},metaData:d});P++,D.push(...E),n&&D.length>=n&&(D=D.slice(0,n),b=!1),I===D.length&&(b=!1)}catch(E){x(!1),b=!1,c==null||c(E);return}new fo.ExportToCsv({filename:m,useKeysAsHeaders:!0,...a}).generateCsv(D.map(s)),x(!1)}}};var yo=h(y("react"));var Nu=({action:e,resource:r,id:t,onMutationSuccess:n,onMutationError:o,redirect:s,successNotification:a,errorNotification:d,metaData:p,mutationMode:c,liveMode:R,onLiveEvent:x,liveParams:f,undoableTimeout:i,dataProviderName:u,invalidates:l,queryOptions:T}={})=>{var rt;let{useParams:m}=L(),{resource:C,action:g,id:D}=m(),P=!r||r===C?t!=null?t:D:t,[b,v]=yo.default.useState(P),E=r!=null?r:C,I=(rt=e!=null?e:g)!=null?rt:"create",S=q()(E),{mutationMode:N}=te(),w=c!=null?c:N,z=I==="create",B=I==="edit",U=I==="clone",O=s!=null?s:"list",$=b!==void 0&&(B||U),Pe=$e({resource:S.name,id:b!=null?b:"",queryOptions:{enabled:$,...T},liveMode:R,onLiveEvent:x,liveParams:f,metaData:p,dataProviderName:u}),{isFetching:fe}=Pe,oe=We(),{mutate:Ze,isLoading:Ee}=oe,ye=kt(),{mutate:Ce,isLoading:et}=ye,{setWarnWhen:ne}=ze(),Me=Co();return{...z||U?{formLoading:fe||Ee,mutationResult:oe,onFinish:async X=>{ne(!1);let se=ae=>{Me({redirect:O,resource:S,id:ae})};return w!=="pessimistic"&&setTimeout(()=>{se()}),new Promise((ae,V)=>(w!=="pessimistic"&&ae(),Ze({values:X,resource:S.name,successNotification:a,errorNotification:d,metaData:p,dataProviderName:u,invalidates:l},{onSuccess:(W,de,Te)=>{var lr;n&&n(W,X,Te);let xe=(lr=W==null?void 0:W.data)==null?void 0:lr.id;se(xe),ae(W)},onError:(W,de,Te)=>{if(o)return o(W,X,Te);V()}})))}}:{formLoading:fe||et,mutationResult:ye,onFinish:async X=>{ne(!1);let se={id:b!=null?b:"",values:X,resource:S.name,mutationMode:w,undoableTimeout:i,successNotification:a,errorNotification:d,metaData:p,dataProviderName:u,invalidates:l},ae=()=>{v(P),Me({redirect:O,resource:S,id:b})};return w!=="pessimistic"&&setTimeout(()=>{ae()}),new Promise((V,W)=>(w!=="pessimistic"&&V(),setTimeout(()=>{Ce(se,{onSuccess:(de,Te,xe)=>{n&&n(de,X,xe),w==="pessimistic"&&ae(),V(de)},onError:(de,Te,xe)=>{if(o)return o(de,X,xe);W()}})})))}},queryResult:Pe,id:b,setId:v,redirect:(X,se)=>{Me({redirect:X!==void 0?X:B?"list":"edit",resource:S,id:se!=null?se:b})}}};var To=y("react");var Co=()=>{let{show:e,edit:r,list:t,create:n}=j();return(0,To.useCallback)(({redirect:s,resource:a,id:d})=>{if(s&&a.route)return a.canShow&&s==="show"&&d?e(a.route,d):a.canEdit&&s==="edit"&&d?r(a.route,d):a.canCreate&&s==="create"?n(a.route):t(a.route,"push")},[])};var j=()=>{let{useHistory:e}=L(),r=e(),t=q(),n=(m,C="push")=>{C==="push"?r.push(m):r.replace(m)},o=m=>`/${t(m).route}/create`,s=(m,C)=>{let g=t(m),D=encodeURIComponent(C);return`/${g.route}/edit/${D}`},a=(m,C)=>{let g=t(m),D=encodeURIComponent(C);return`/${g.route}/clone/${D}`},d=(m,C)=>{let g=t(m),D=encodeURIComponent(C);return`/${g.route}/show/${D}`},p=m=>`/${t(m).route}`;return{create:(m,C="push")=>{n(o(m),C)},createUrl:o,edit:(m,C,g="push")=>{n(s(m,C),g)},editUrl:s,clone:(m,C,g="push")=>{n(a(m,C),g)},cloneUrl:a,show:(m,C,g="push")=>{n(d(m,C),g)},showUrl:d,list:(m,C="push")=>{n(p(m),C)},listUrl:p,push:(m,C)=>{r.push(m,C)},replace:(m,C)=>{r.replace(m,C)},goBack:()=>{r.goBack()}}};var xo=y("react");var _u=({resource:e,id:r,successNotification:t,errorNotification:n,metaData:o,liveMode:s,onLiveEvent:a,dataProviderName:d}={})=>{let{useParams:p}=L(),{resource:c,id:R}=p(),x=!e||e===c?r!=null?r:R:r,[f,i]=(0,xo.useState)(x),l=q()(e!=null?e:c);return{queryResult:$e({resource:l.name,id:f!=null?f:"",queryOptions:{enabled:f!==void 0},successNotification:t,errorNotification:n,metaData:o,liveMode:s,onLiveEvent:a,dataProviderName:d}),showId:f,setShowId:i}};var Ne=y("react"),Ro=y("papaparse"),go=h(y("lodash/chunk"));var Zu=({resourceName:e,mapData:r=d=>d,paparseOptions:t,batchSize:n=Number.MAX_SAFE_INTEGER,onFinish:o,metaData:s,onProgress:a}={})=>{let[d,p]=(0,Ne.useState)(0),[c,R]=(0,Ne.useState)(0),[x,f]=(0,Ne.useState)(!1),i=q(),{useParams:u}=L(),{resource:l}=u(),{name:T}=i(e!=null?e:l),m=$t(),C=We(),g;n===1?g=C:g=m;let D=()=>{R(0),p(0),f(!1)},P=v=>{let E={succeeded:v.filter(I=>I.type==="success"),errored:v.filter(I=>I.type==="error")};o==null||o(E),f(!1)};(0,Ne.useEffect)(()=>{a==null||a({totalAmount:c,processedAmount:d})},[c,d]);let b=({file:v})=>(D(),new Promise(E=>{f(!0),(0,Ro.parse)(v,{complete:async({data:I})=>{let A=ot(I,r);if(R(A.length),n===1){let S=await Promise.all(A.map(N=>({response:C.mutateAsync({resource:T,values:N,successNotification:!1,errorNotification:!1,metaData:s}),value:N})).map(({response:N,value:w})=>N.then(({data:z})=>(p(B=>B+1),{response:[z],type:"success",request:[w]})).catch(z=>({response:[z],type:"error",request:[w]}))));E(S)}else{let S=await Promise.all((0,go.default)(A,n).map(N=>({response:m.mutateAsync({resource:T,values:N,successNotification:!1,errorNotification:!1,metaData:s}),currentBatchLength:N.length,value:N})).map(({response:N,value:w,currentBatchLength:z})=>N.then(B=>(p(U=>U+z),{response:B.data,type:"success",request:w})).catch(B=>({response:[B],type:"error",request:w}))));E(S)}},...t})}).then(E=>(P(E),E)));return{inputProps:{type:"file",accept:".csv",onChange:v=>{v.target.files&&v.target.files.length>0&&b({file:v.target.files[0]})}},mutationResult:g,isLoading:x,handleChange:b}};var Je=y("react"),tc=({defaultVisible:e=!1}={})=>{let[r,t]=(0,Je.useState)(e),n=(0,Je.useCallback)(()=>t(!0),[r]),o=(0,Je.useCallback)(()=>t(!1),[r]);return{visible:r,show:n,close:o}};var bo=y("react");var Zt=h(y("react")),mn={useHistory:()=>!1,useLocation:()=>!1,useParams:()=>({}),Prompt:()=>null,Link:()=>null},Ye=Zt.default.createContext(mn),Do=({children:e,useHistory:r,useLocation:t,useParams:n,Prompt:o,Link:s,routes:a})=>Zt.default.createElement(Ye.Provider,{value:{useHistory:r,useLocation:t,useParams:n,Prompt:o,Link:s,routes:a}},e);var L=()=>{let{useHistory:e,useLocation:r,useParams:t,Prompt:n,Link:o,routes:s}=(0,bo.useContext)(Ye);return{useHistory:e,useLocation:r,useParams:t,Prompt:n,Link:o,routes:s}};var vo=y("react"),Po=y("react-query");var er=h(y("react"));var ge=er.default.createContext({}),ho=({can:e,children:r})=>er.default.createElement(ge.Provider,{value:{can:e}},r);var Eo=({action:e,resource:r,params:t,queryOptions:n})=>{let{can:o}=(0,vo.useContext)(ge),s=(0,Po.useQuery)(["useCan",{action:e,resource:r,params:t}],()=>{var a;return(a=o==null?void 0:o({action:e,resource:r,params:t}))!=null?a:{can:!0}},{enabled:typeof o<"u",...n,retry:!1});return typeof o>"u"?{data:{can:!0}}:s};var Mo=y("react");var Cc=()=>{let{can:e}=(0,Mo.useContext)(ge);return{can:e}};var we=y("react"),So=h(y("lodash/uniqBy")),Io=h(y("lodash/debounce"));var bc=e=>{let[r,t]=(0,we.useState)([]),[n,o]=(0,we.useState)([]),[s,a]=(0,we.useState)([]),{resource:d,sort:p,filters:c=[],optionLabel:R="title",optionValue:x="id",debounce:f=300,successNotification:i,errorNotification:u,defaultValueQueryOptions:l,queryOptions:T,fetchSize:m,liveMode:C,defaultValue:g=[],onLiveEvent:D,onSearch:P,liveParams:b,metaData:v,dataProviderName:E}=e,I=Array.isArray(g)?g:[g],A=U=>{a(U.data.map(O=>({label:O[R],value:O[x]})))},S=l!=null?l:T,N=Vt({resource:d,ids:I,queryOptions:{enabled:I.length>0,...S,onSuccess:U=>{var O;A(U),(O=S==null?void 0:S.onSuccess)==null||O.call(S,U)}},metaData:v,liveMode:"off",dataProviderName:E}),w=U=>{o(U.data.map(O=>({label:O[R],value:O[x]})))},z=He({resource:d,config:{sort:p,filters:c.concat(r),pagination:m?{pageSize:m}:void 0},queryOptions:{...T,onSuccess:U=>{var O;w(U),(O=T==null?void 0:T.onSuccess)==null||O.call(T,U)}},successNotification:i,errorNotification:u,metaData:v,liveMode:C,liveParams:b,onLiveEvent:D,dataProviderName:E}),B=U=>{if(!U){t([]);return}t(P?P(U):[{field:R,operator:"contains",value:U}])};return{queryResult:z,defaultValueQueryResult:N,options:(0,we.useMemo)(()=>(0,So.default)([...n,...s],"value"),[n,s]),onSearch:(0,Io.default)(B,f)}};var ue=y("react"),tr=h(y("lodash/differenceWith")),rr=h(y("lodash/isEqual"));var fn=[],yn=[];function Ec({initialCurrent:e=1,initialPageSize:r=10,hasPagination:t=!0,initialSorter:n,permanentSorter:o=yn,defaultSetFilterBehavior:s="merge",initialFilter:a,permanentFilter:d=fn,syncWithLocation:p,resource:c,successNotification:R,errorNotification:x,queryOptions:f,liveMode:i,onLiveEvent:u,liveParams:l,metaData:T,dataProviderName:m}={}){var ae;let{syncWithLocation:C}=Xt(),g=p!=null?p:C,{useLocation:D,useParams:P}=L(),{search:b,pathname:v}=D(),E=Xr(i),{parsedCurrent:I,parsedPageSize:A,parsedSorter:S,parsedFilters:N}=at(b),w=I||e,z=A||r,B=S.length?S:n,U=N.length?N:a,{resource:O}=P(),{push:$}=j(),fe=q()(c!=null?c:O),[oe,Ze]=(0,ue.useState)(pt(o,B!=null?B:[])),[Ee,ye]=(0,ue.useState)(ct(d,U!=null?U:[])),[Ce,et]=(0,ue.useState)(w),[ne,Me]=(0,ue.useState)(z),ir=({pagination:{current:V,pageSize:W},sorter:de,filters:Te})=>{let xe=it({pagination:{pageSize:W,current:V},sorter:de,filters:Te});return`${v}?${xe}`};(0,ue.useEffect)(()=>{b===""&&(et(w),Me(z),Ze(pt(o,B!=null?B:[])),ye(ct(d,U!=null?U:[])))},[b]),(0,ue.useEffect)(()=>{if(g){let V=it({...t?{pagination:{pageSize:ne,current:Ce}}:{},sorter:(0,tr.default)(oe,o,rr.default),filters:(0,tr.default)(Ee,d,rr.default)});return $(`${v}?${V}`)}},[g,Ce,ne,oe,Ee]);let tt=He({resource:fe.name,config:{hasPagination:t,pagination:{current:Ce,pageSize:ne},filters:Ue(d,Ee),sort:ut(o,oe)},queryOptions:f,successNotification:R,errorNotification:x,metaData:T,liveMode:E,liveParams:l,onLiveEvent:u,dataProviderName:m}),ur=V=>{ye(W=>Ue(d,V,W))},cr=V=>{ye(Ue(d,V))},pr=V=>{ye(W=>Ue(d,V(W)))},rt=(V,W=s)=>{typeof V=="function"?pr(V):W==="replace"?cr(V):ur(V)},X=V=>{Ze(()=>ut(o,V))},se=(0,ue.useMemo)(()=>{var V,W;return t?{current:Ce,setCurrent:et,pageSize:ne,setPageSize:Me,pageCount:ne?Math.ceil(((W=(V=tt.data)==null?void 0:V.total)!=null?W:0)/ne):1}:{current:void 0,setCurrent:void 0,pageSize:void 0,setPageSize:void 0,pageCount:void 0}},[t,Ce,ne,(ae=tt.data)==null?void 0:ae.total]);return{tableQueryResult:tt,sorter:oe,setSorter:X,filters:Ee,setFilters:rt,...se,createLinkForSyncWithLocation:ir}}var nr=y("react"),je=y("react-query");var or=h(y("react")),De=or.default.createContext({}),Lo=({create:e,get:r,update:t,children:n})=>or.default.createElement(De.Provider,{value:{create:e,get:r,update:t}},n);var Be=()=>{let e=(0,je.useQueryClient)(),r=(0,nr.useContext)(De),{resources:t}=(0,nr.useContext)(Re),{data:n,refetch:o,isLoading:s}=Mt({queryOptions:{enabled:!!r}}),a=(0,je.useMutation)(async p=>{var f,i,u;let c=t.find(l=>l.name===p.resource),R=(i=(f=c==null?void 0:c.options)==null?void 0:f.auditLog)==null?void 0:i.permissions;if(R&&!Qt(R,p.action))return;let x;return s&&(x=await o()),await((u=r.create)==null?void 0:u.call(r,{...p,author:n!=null?n:x==null?void 0:x.data}))}),d=(0,je.useMutation)(async p=>{var c;return await((c=r.update)==null?void 0:c.call(r,p))},{onSuccess:p=>{if(p!=null&&p.resource){let c=k(p==null?void 0:p.resource);e.invalidateQueries(c.logList())}}});return{log:a,rename:d}};var Uo=y("react"),Qo=y("react-query");var Kc=({resource:e,action:r,meta:t,author:n,metaData:o,queryOptions:s})=>{let{get:a}=(0,Uo.useContext)(De),d=k(e,void 0,o);return(0,Qo.useQuery)(d.logList(t),()=>{var c;return(c=a==null?void 0:a({resource:e,action:r,author:n,meta:t,metaData:o}))!=null?c:Promise.resolve([])},{enabled:typeof a<"u",...s,retry:!1})};var Ao=y("react"),Bo=y("react-query");var ee=()=>{let e=(0,Bo.useQueryClient)();return(0,Ao.useCallback)(({resource:t,dataProviderName:n,invalidates:o,id:s})=>{if(o===!1)return;let a=k(t,n);o.forEach(d=>{switch(d){case"all":e.invalidateQueries(a.all);break;case"list":e.invalidateQueries(a.list());break;case"many":e.invalidateQueries(a.many());break;case"resourceAll":e.invalidateQueries(a.resourceAll);break;case"detail":e.invalidateQueries(a.detail(s||""));break;default:break}})},[])};var Vo=y("react"),Xe=h(y("humanize-string")),No=h(y("warn-once"));var Jc=()=>{var p;let{useParams:e}=L(),{i18nProvider:r}=(0,Vo.useContext)(re),t=M(),{resources:n,resource:o}=Ve(),{action:s}=e(),a=[];if(!(o!=null&&o.name))return{breadcrumbs:a};let d=c=>{var x;let R=n.find(f=>f.name===c);R&&(R.parentName&&d(R.parentName),a.push({label:(x=R.label)!=null?x:t(`${R.name}.${R.name}`,(0,Xe.default)(R.name)),href:R.list?`/${R.route}`:void 0,icon:R.icon}))};if(o.parentName&&d(o.parentName),a.push({label:(p=o.label)!=null?p:t(`${o.name}.${o.name}`,(0,Xe.default)(o.name)),href:o.list?`/${o.route}`:void 0,icon:o.icon}),s){let c=`actions.${s}`,R=t(c);typeof r<"u"&&R===c?((0,No.default)(!0,`[useBreadcrumb]: Breadcrumb missing translate key for the "${s}" action. Please add "actions.${s}" key to your translation file.
For more information, see https://refine.dev/docs/core/hooks/useBreadcrumb/#i18n-support`),a.push({label:t(`buttons.${s}`,(0,Xe.default)(s))})):a.push({label:t(c,(0,Xe.default)(s))})}return{breadcrumbs:a}};var be=h(y("react"));var Cn=()=>{let{resources:e}=Ve(),r=M(),{useLocation:t,useParams:n}=L(),o=t(),s=n(),{hasDashboard:a}=qe(),d=be.default.useMemo(()=>{let i=e.find(l=>(o==null?void 0:o.pathname)===`/${l.route}`);i||(i=e.find(l=>(s==null?void 0:s.resource)===l.route));let u;return i!=null&&i.route?u=`/${i==null?void 0:i.route}`:o.pathname==="/"?u="/":u=o==null?void 0:o.pathname,u},[e,o,s]),p=be.default.useMemo(()=>e.map(i=>{var l,T;let u=`/${i.route}`;return{...i,icon:i.icon,route:u,key:(l=i.key)!=null?l:u,label:(T=i.label)!=null?T:r(`${i.name}.${i.name}`,Se(i.name,"plural"))}}),[e,a]),c=be.default.useMemo(()=>nt(p),[p]),R=be.default.useCallback((i,u,l=!1)=>{let T=u.find(m=>l?m.name===i:m.route===i);if(T){let m=[];return l&&T.route&&m.unshift(T.route),T.parentName&&m.unshift(...R(T.parentName,u,!0)),m}return[]},[]),x=be.default.useMemo(()=>R(d,p),[d,p]);return be.default.useMemo(()=>{let i=u=>u.reduce((l,T)=>T.children.length>0?[...l,{...T,children:i(T.children)}]:typeof T.list<"u"?[...l,T]:l,[]);return{defaultOpenKeys:x,selectedKey:d,menuItems:i(c)}},[x,d,c])};var Tn=()=>{let[e,r]=(0,ce.useState)(),{push:t}=j(),n=M(),o=["edit","create","show"],{useParams:s}=L(),a=s(),d=q();return(0,ce.useEffect)(()=>{if(a.resource){let p=d(a.resource);a.action&&o.includes(a.action)&&!p[a.action]&&r(n("pages.error.info",{action:a.action,resource:a.resource},`You may have forgotten to add the "${a.action}" component to "${a.resource}" resource.`))}},[a]),ce.default.createElement(ce.default.Fragment,null,ce.default.createElement("h1",null,n("pages.error.404",void 0,"Sorry, the page you visited does not exist.")),e&&ce.default.createElement("p",null,e),ce.default.createElement("button",{onClick:()=>t("/")},n("pages.error.backHome",void 0,"Back Home")))};var F=h(y("react"));var zt=()=>{let[e,r]=(0,F.useState)(""),[t,n]=(0,F.useState)(""),o=M(),{mutate:s}=It();return F.default.createElement(F.default.Fragment,null,F.default.createElement("h1",null,o("pages.login.title","Sign in your account")),F.default.createElement("form",{onSubmit:a=>{a.preventDefault(),s({username:e,password:t})}},F.default.createElement("table",null,F.default.createElement("tbody",null,F.default.createElement("tr",null,F.default.createElement("td",null,o("pages.login.username",void 0,"username"),":"),F.default.createElement("td",null,F.default.createElement("input",{type:"text",size:20,autoCorrect:"off",spellCheck:!1,autoCapitalize:"off",autoFocus:!0,required:!0,value:e,onChange:a=>r(a.target.value)}))),F.default.createElement("tr",null,F.default.createElement("td",null,o("pages.login.password",void 0,"password"),":"),F.default.createElement("td",null,F.default.createElement("input",{type:"password",required:!0,size:20,value:t,onChange:a=>n(a.target.value)}))))),F.default.createElement("br",null),F.default.createElement("input",{type:"submit",value:"login"})))};var Y=h(y("react")),sr=()=>Y.default.createElement(Y.default.Fragment,null,Y.default.createElement("h1",null,"Welcome on board"),Y.default.createElement("p",null,"Your configuration is completed."),Y.default.createElement("p",null,"Now you can get started by adding your resources to the"," ",Y.default.createElement("code",null,"`resources`")," property of ",Y.default.createElement("code",null,"`<Refine>`")),Y.default.createElement("div",{style:{display:"flex",gap:8}},Y.default.createElement("a",{href:"https://refine.dev",target:"_blank",rel:"noreferrer"},Y.default.createElement("button",null,"Documentation")),Y.default.createElement("a",{href:"https://refine.dev/docs/examples/tutorial",target:"_blank",rel:"noreferrer"},Y.default.createElement("button",null,"Examples")),Y.default.createElement("a",{href:"https://discord.gg/refine",target:"_blank",rel:"noreferrer"},Y.default.createElement("button",null,"Community"))));var H=h(y("react")),vt=y("react-query"),Ho=y("react-query/devtools");var ko=y("react"),ht=y("jose");var le=y("react");var xn="3.54.0",wo=()=>{let e=(0,le.useContext)(G),r=(0,le.useContext)(De),t=(0,le.useContext)(pe),n=(0,le.useContext)(Ye),o=(0,le.useContext)(Fe),{i18nProvider:s}=(0,le.useContext)(re),a=(0,le.useContext)(Ge),d=(0,le.useContext)(ge),{resources:p}=Ve(),c=e.isProvided,R=!!r.create||!!r.get||!!r.update,x=!!(t!=null&&t.publish)||!!(t!=null&&t.subscribe)||!!(t!=null&&t.unsubscribe),f=!!n.useHistory||!!n.Link||!!n.Prompt||!!n.useLocation||!!n.useParams,i=!!o,u=!!(s!=null&&s.changeLocale)||!!(s!=null&&s.getLocale)||!!(s!=null&&s.translate),l=!!a.close||!!a.open,T=!!d.can;return{providers:{auth:c,auditLog:R,live:x,router:f,data:i,i18n:u,notification:l,accessControl:T},version:xn,resourceCount:p.length}};var Rn={kty:"RSA",e:"AQAB",use:"enc",alg:"RSA-OAEP-256",n:"glC_mSwk1VqaofnOPXK3HEC5njb4uHZM5_shFdQLRn_898dxVUMK7HkyOgoVOtEsNxDBjwK_KPbSEYX_lyfrJ6ONjnxPJ2_d0W_1ZwdwT_gr5ofFLz5Bm7WbVHcKDK1j5iMYsqUJbFVQ-KXzAswae2iiqzCBKLD4y-fLsIvOUGZliERMMi54hRPqVj6p0xhJEvH22jZ5rk48KJBNvjBBuLes1qk5cehirDHnh07A8Alr3Pe6Qk7xpyC_mUvMqX99JvYThyvjQMMPEXHLJY9m1g-sgHJPlMkxMoLUd5JI1v6QMLezhq2F-bNXiRgXJgT0ew3g-H_PKpWmMQmSRtgiEw"},Ko=()=>{let e=wo();return(0,ko.useEffect)(()=>{typeof window>"u"||(async()=>{let r=await(0,ht.importJWK)(Rn),t=await new ht.CompactEncrypt(new TextEncoder().encode(JSON.stringify(e))).setProtectedHeader({alg:"RSA-OAEP-256",enc:"A256GCM"}).encrypt(r);fetch("https://telemetry.refine.dev/send",{headers:{Accept:"application/text","Content-Type":"application/text"},method:"POST",body:t})})()},[]),null};var gn=({authProvider:e,dataProvider:r,routerProvider:t,notificationProvider:n,accessControlProvider:o,auditLogProvider:s,resources:a,DashboardPage:d,ReadyPage:p,LoginPage:c,catchAll:R,children:x,liveProvider:f,i18nProvider:i,mutationMode:u="pessimistic",syncWithLocation:l=!1,warnWhenUnsavedChanges:T=!1,undoableTimeout:m=5e3,Title:C,Layout:g,Sider:D,Header:P,Footer:b,OffLayoutArea:v,reactQueryClientConfig:E,reactQueryDevtoolConfig:I,liveMode:A,onLiveEvent:S,disableTelemetry:N=!1})=>{var O;let w=new vt.QueryClient({...E,defaultOptions:{...E==null?void 0:E.defaultOptions,queries:{refetchOnWindowFocus:!1,keepPreviousData:!0,...(O=E==null?void 0:E.defaultOptions)==null?void 0:O.queries}}}),z=typeof n=="function"?n():n!=null?n:{},B=[];if(a==null||a.map($=>{var Pe,fe,oe;B.push({key:$.key,name:$.name,label:(Pe=$.options)==null?void 0:Pe.label,icon:$.icon,route:(oe=(fe=$.options)==null?void 0:fe.route)!=null?oe:Ie($,a),canCreate:!!$.create,canEdit:!!$.edit,canShow:!!$.show,canDelete:$.canDelete,create:$.create,show:$.show,list:$.list,edit:$.edit,options:$.options,parentName:$.parentName})}),B.length===0)return p?H.default.createElement(p,null):H.default.createElement(sr,null);let{RouterComponent:U=H.default.Fragment}=t;return H.default.createElement(vt.QueryClientProvider,{client:w},H.default.createElement(oo,{...z},H.default.createElement(fr,{...e!=null?e:{},isProvided:Boolean(e)},H.default.createElement(_r,{...r},H.default.createElement(zr,{liveProvider:f},H.default.createElement(Do,{...t},H.default.createElement(eo,{resources:B},H.default.createElement(ao,{i18nProvider:i},H.default.createElement(ho,{...o!=null?o:{}},H.default.createElement(Lo,{...s!=null?s:{}},H.default.createElement(Nt,null,H.default.createElement(Jr,{mutationMode:u,warnWhenUnsavedChanges:T,syncWithLocation:l,Title:C,undoableTimeout:m,catchAll:R,DashboardPage:d,LoginPage:c,Layout:g,Sider:D,Footer:b,Header:P,OffLayoutArea:v,hasDashboard:!!d,liveMode:A,onLiveEvent:S},H.default.createElement(uo,null,H.default.createElement(U,null,x,!N&&H.default.createElement(Ko,null),H.default.createElement(ar,null)))))))))))))),H.default.createElement(Ho.ReactQueryDevtools,{initialIsOpen:!1,position:"bottom-right",...I}))};var $o=y("react");var Kr=({notifications:e})=>{let r=M(),{notificationDispatch:t}=ie(),{open:n}=me(),o=()=>{e.forEach(s=>{s.isRunning===!0&&(s.seconds===0&&s.doMutation(),s.isSilent||n==null||n({key:`${s.id}-${s.resource}-notification`,type:"progress",message:r("notifications.undoable",{seconds:Ke(s.seconds)},`You have ${Ke(s.seconds)} seconds to undo`),cancelMutation:s.cancelMutation,undoableTimeout:Ke(s.seconds)}),s.seconds>0&&setTimeout(()=>{t({type:"DECREASE_NOTIFICATION_SECOND",payload:{id:s.id,seconds:s.seconds,resource:s.resource}})},1e3))})};return(0,$o.useEffect)(()=>{o()},[e]),null};var ke=h(y("react"));var Dn=({children:e,Layout:r,Sider:t,Header:n,Title:o,Footer:s,OffLayoutArea:a})=>{let{Layout:d,Footer:p,Header:c,Sider:R,Title:x,OffLayoutArea:f}=qe(),i=r!=null?r:d;return ke.default.createElement(i,{Sider:t!=null?t:R,Header:n!=null?n:c,Footer:s!=null?s:p,Title:o!=null?o:x,OffLayoutArea:a!=null?a:f},e,ke.default.createElement(bn,null))},bn=()=>{let{Prompt:e}=L(),r=M(),{warnWhen:t,setWarnWhen:n}=ze(),o=s=>(s.preventDefault(),s.returnValue=r("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes."),s.returnValue);return(0,ke.useEffect)(()=>(t&&window.addEventListener("beforeunload",o),window.removeEventListener("beforeunload",o)),[t]),ke.default.createElement(e,{when:t,message:r("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes."),setWarnWhen:n})};var he=h(y("react"));var hn=({children:e,fallback:r,loading:t})=>{let{isSuccess:n,isLoading:o,isError:s}=Lt(),{replace:a}=j(),{useLocation:d}=L(),{pathname:p,search:c}=d();if(o)return he.default.createElement(he.default.Fragment,null,t)||null;if(s){if(!r){let R=`${p}${c}`;return p.includes("/login")||a(`/login?to=${encodeURIComponent(R)}`),null}return he.default.createElement(he.default.Fragment,null,r)}return n?he.default.createElement(he.default.Fragment,null,e):null};var Pt=y("react");var ar=()=>{let{useLocation:e}=L(),{checkAuth:r}=(0,Pt.useContext)(G),t=e();return(0,Pt.useEffect)(()=>{r==null||r().catch(()=>!1)},[t==null?void 0:t.pathname]),null};var ve=h(y("react"));var vn=({resource:e,action:r,params:t,fallback:n,children:o,...s})=>{let{data:a}=Eo({resource:e,action:r,params:t});return a!=null&&a.can?ve.default.isValidElement(o)?ve.default.cloneElement(o,s):ve.default.createElement(ve.default.Fragment,null,o):(a==null?void 0:a.can)===!1?ve.default.createElement(ve.default.Fragment,null,n!=null?n:null):null};})();
//# sourceMappingURL=index.js.map